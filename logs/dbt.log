[0m14:29:26.289343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fde1fa9be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fde35a5d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fde14a56d0>]}


============================== 14:29:26.293255 | cc45cb28-6179-4444-b589-969d6ef929a3 ==============================
[0m14:29:26.293255 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:29:26.293826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m14:29:26.304772 [info ] [MainThread]: dbt version: 1.9.4
[0m14:29:26.305256 [info ] [MainThread]: python version: 3.13.3
[0m14:29:26.305643 [info ] [MainThread]: python path: /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/.venv/bin/python3
[0m14:29:26.306207 [info ] [MainThread]: os info: Linux-6.14.0-15-generic-x86_64-with-glibc2.41
[0m14:29:26.381110 [info ] [MainThread]: Using profiles dir at /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt
[0m14:29:26.381606 [info ] [MainThread]: Using profiles.yml file at /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/profiles.yml
[0m14:29:26.381986 [info ] [MainThread]: Using dbt_project.yml file at /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/dbt_project.yml
[0m14:29:26.382616 [info ] [MainThread]: adapter type: postgres
[0m14:29:26.383005 [info ] [MainThread]: adapter version: 1.9.0
[0m14:29:26.383482 [info ] [MainThread]: Configuration:
[0m14:29:26.383946 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:29:26.384402 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m14:29:26.384982 [info ] [MainThread]: Required dependencies:
[0m14:29:26.385658 [debug] [MainThread]: Executing "git --help"
[0m14:29:26.389874 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:29:26.390805 [debug] [MainThread]: STDERR: "b''"
[0m14:29:26.391330 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:29:26.391815 [info ] [MainThread]: Connection:
[0m14:29:26.392323 [info ] [MainThread]:   host: 127.0.0.1
[0m14:29:26.392732 [info ] [MainThread]:   port: 5432
[0m14:29:26.393156 [info ] [MainThread]:   user: dbuser
[0m14:29:26.393537 [info ] [MainThread]:   database: analytics
[0m14:29:26.394042 [info ] [MainThread]:   schema: staging
[0m14:29:26.394424 [info ] [MainThread]:   connect_timeout: 10
[0m14:29:26.394991 [info ] [MainThread]:   role: None
[0m14:29:26.395361 [info ] [MainThread]:   search_path: None
[0m14:29:26.395733 [info ] [MainThread]:   keepalives_idle: 0
[0m14:29:26.396186 [info ] [MainThread]:   sslmode: None
[0m14:29:26.396553 [info ] [MainThread]:   sslcert: None
[0m14:29:26.396981 [info ] [MainThread]:   sslkey: None
[0m14:29:26.397361 [info ] [MainThread]:   sslrootcert: None
[0m14:29:26.397741 [info ] [MainThread]:   application_name: dbt
[0m14:29:26.398222 [info ] [MainThread]:   retries: 1
[0m14:29:26.398914 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:29:26.478362 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:29:26.503663 [debug] [MainThread]: Using postgres connection "debug"
[0m14:29:26.504124 [debug] [MainThread]: On debug: select 1 as id
[0m14:29:26.504481 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:29:26.521643 [debug] [MainThread]: SQL status: SELECT 1 in 0.017 seconds
[0m14:29:26.522756 [debug] [MainThread]: On debug: Close
[0m14:29:26.523177 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:29:26.523561 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:29:26.523917 [info ] [MainThread]: Project loading failed for the following reason:
 project path </home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/dbt_project.yml> not found

[0m14:29:26.526166 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.29374135, "process_in_blocks": "3984", "process_kernel_time": 0.195286, "process_mem_max_rss": "109200", "process_out_blocks": "24", "process_user_time": 1.627055}
[0m14:29:26.527257 [debug] [MainThread]: Command `dbt debug` failed at 14:29:26.526994 after 0.30 seconds
[0m14:29:26.528197 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:29:26.528804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fde03f8510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fddffec170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fde0e648d0>]}
[0m14:29:26.529500 [debug] [MainThread]: Flushing usage events
[0m14:29:27.719239 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:35:21.200302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e3eb49dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e3eccc9d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e3eab756d0>]}


============================== 14:35:21.205012 | ab14fcba-cc89-4e91-bcbc-8c5b91f2e1b7 ==============================
[0m14:35:21.205012 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:35:21.205901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:35:21.222304 [info ] [MainThread]: dbt version: 1.9.4
[0m14:35:21.222946 [info ] [MainThread]: python version: 3.13.3
[0m14:35:21.223376 [info ] [MainThread]: python path: /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/.venv/bin/python3
[0m14:35:21.223786 [info ] [MainThread]: os info: Linux-6.14.0-15-generic-x86_64-with-glibc2.41
[0m14:35:21.323095 [info ] [MainThread]: Using profiles dir at /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt
[0m14:35:21.323574 [info ] [MainThread]: Using profiles.yml file at /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/profiles.yml
[0m14:35:21.323957 [info ] [MainThread]: Using dbt_project.yml file at /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/dbt_project.yml
[0m14:35:21.324589 [info ] [MainThread]: adapter type: postgres
[0m14:35:21.324983 [info ] [MainThread]: adapter version: 1.9.0
[0m14:35:21.447616 [info ] [MainThread]: Configuration:
[0m14:35:21.448238 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:35:21.448635 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:35:21.449068 [info ] [MainThread]: Required dependencies:
[0m14:35:21.449587 [debug] [MainThread]: Executing "git --help"
[0m14:35:21.453460 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:35:21.454230 [debug] [MainThread]: STDERR: "b''"
[0m14:35:21.454685 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:35:21.455152 [info ] [MainThread]: Connection:
[0m14:35:21.455644 [info ] [MainThread]:   host: 127.0.0.1
[0m14:35:21.456116 [info ] [MainThread]:   port: 5432
[0m14:35:21.456477 [info ] [MainThread]:   user: dbuser
[0m14:35:21.456821 [info ] [MainThread]:   database: analytics
[0m14:35:21.457182 [info ] [MainThread]:   schema: staging
[0m14:35:21.457614 [info ] [MainThread]:   connect_timeout: 10
[0m14:35:21.458066 [info ] [MainThread]:   role: None
[0m14:35:21.458426 [info ] [MainThread]:   search_path: None
[0m14:35:21.458771 [info ] [MainThread]:   keepalives_idle: 0
[0m14:35:21.459129 [info ] [MainThread]:   sslmode: None
[0m14:35:21.459467 [info ] [MainThread]:   sslcert: None
[0m14:35:21.459799 [info ] [MainThread]:   sslkey: None
[0m14:35:21.460157 [info ] [MainThread]:   sslrootcert: None
[0m14:35:21.460483 [info ] [MainThread]:   application_name: dbt
[0m14:35:21.460818 [info ] [MainThread]:   retries: 1
[0m14:35:21.461412 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:35:21.540186 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:35:21.570726 [debug] [MainThread]: Using postgres connection "debug"
[0m14:35:21.571350 [debug] [MainThread]: On debug: select 1 as id
[0m14:35:21.571707 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:35:21.593985 [debug] [MainThread]: SQL status: SELECT 1 in 0.022 seconds
[0m14:35:21.595019 [debug] [MainThread]: On debug: Close
[0m14:35:21.595417 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:35:21.595789 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:35:21.597382 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.45815974, "process_in_blocks": "19016", "process_kernel_time": 0.209851, "process_mem_max_rss": "110400", "process_out_blocks": "24", "process_user_time": 1.732516}
[0m14:35:21.598203 [debug] [MainThread]: Command `dbt debug` succeeded at 14:35:21.598043 after 0.46 seconds
[0m14:35:21.598663 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:35:21.599215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e3e9f13ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e3e9f9dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e3ea5c4af0>]}
[0m14:35:21.599831 [debug] [MainThread]: Flushing usage events
[0m14:35:22.265808 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:05:24.144806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718568e9dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71856a4add10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185683996d0>]}


============================== 17:05:24.151830 | 49eb3621-6754-4e4b-9af1-9a51918e83e7 ==============================
[0m17:05:24.151830 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:05:24.152774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m17:05:24.176143 [info ] [MainThread]: dbt version: 1.9.4
[0m17:05:24.176998 [info ] [MainThread]: python version: 3.13.3
[0m17:05:24.177536 [info ] [MainThread]: python path: /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/.venv/bin/python3
[0m17:05:24.178069 [info ] [MainThread]: os info: Linux-6.14.0-15-generic-x86_64-with-glibc2.41
[0m17:05:24.287938 [info ] [MainThread]: Using profiles dir at /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt
[0m17:05:24.288480 [info ] [MainThread]: Using profiles.yml file at /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/profiles.yml
[0m17:05:24.288871 [info ] [MainThread]: Using dbt_project.yml file at /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/dbt_project.yml
[0m17:05:24.290143 [info ] [MainThread]: adapter type: postgres
[0m17:05:24.290614 [info ] [MainThread]: adapter version: 1.9.0
[0m17:05:24.425162 [info ] [MainThread]: Configuration:
[0m17:05:24.425701 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:05:24.426199 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:05:24.426581 [info ] [MainThread]: Required dependencies:
[0m17:05:24.427227 [debug] [MainThread]: Executing "git --help"
[0m17:05:24.430687 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:05:24.431356 [debug] [MainThread]: STDERR: "b''"
[0m17:05:24.431753 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:05:24.432239 [info ] [MainThread]: Connection:
[0m17:05:24.432655 [info ] [MainThread]:   host: 127.0.0.1
[0m17:05:24.433090 [info ] [MainThread]:   port: 5432
[0m17:05:24.433469 [info ] [MainThread]:   user: dbuser
[0m17:05:24.433834 [info ] [MainThread]:   database: analytics
[0m17:05:24.434214 [info ] [MainThread]:   schema: staging
[0m17:05:24.434578 [info ] [MainThread]:   connect_timeout: 10
[0m17:05:24.435044 [info ] [MainThread]:   role: None
[0m17:05:24.435398 [info ] [MainThread]:   search_path: None
[0m17:05:24.435968 [info ] [MainThread]:   keepalives_idle: 0
[0m17:05:24.436355 [info ] [MainThread]:   sslmode: None
[0m17:05:24.436844 [info ] [MainThread]:   sslcert: None
[0m17:05:24.437563 [info ] [MainThread]:   sslkey: None
[0m17:05:24.438424 [info ] [MainThread]:   sslrootcert: None
[0m17:05:24.439213 [info ] [MainThread]:   application_name: dbt
[0m17:05:24.439678 [info ] [MainThread]:   retries: 1
[0m17:05:24.440357 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:05:24.530296 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:05:24.571309 [debug] [MainThread]: Using postgres connection "debug"
[0m17:05:24.571823 [debug] [MainThread]: On debug: select 1 as id
[0m17:05:24.572219 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:05:24.594617 [debug] [MainThread]: SQL status: SELECT 1 in 0.022 seconds
[0m17:05:24.595794 [debug] [MainThread]: On debug: Close
[0m17:05:24.596279 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:05:24.596712 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:05:24.599013 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.51344275, "process_in_blocks": "75416", "process_kernel_time": 0.276089, "process_mem_max_rss": "110264", "process_out_blocks": "24", "process_user_time": 1.845494}
[0m17:05:24.599906 [debug] [MainThread]: Command `dbt debug` succeeded at 17:05:24.599686 after 0.51 seconds
[0m17:05:24.600449 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:05:24.601071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71856773bce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185677bdc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718567decaf0>]}
[0m17:05:24.601663 [debug] [MainThread]: Flushing usage events
[0m17:05:26.098352 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:28:05.769478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7769c26b9be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7769c3ec1d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7769c1d916d0>]}


============================== 17:28:05.772898 | f8fb0460-210e-4a5e-af5c-1a63295b06f3 ==============================
[0m17:28:05.772898 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:28:05.773541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_chicago_crimes', 'send_anonymous_usage_stats': 'True'}
[0m17:28:05.774152 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m17:28:05.775420 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.065821014, "process_in_blocks": "8", "process_kernel_time": 0.151624, "process_mem_max_rss": "96604", "process_out_blocks": "16", "process_user_time": 1.477344}
[0m17:28:05.776062 [debug] [MainThread]: Command `dbt run` failed at 17:28:05.775926 after 0.07 seconds
[0m17:28:05.776519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7769c186a060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7769c18ac950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7769c1964af0>]}
[0m17:28:05.777011 [debug] [MainThread]: Flushing usage events
[0m17:28:07.285338 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:28:28.852917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d15989dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d15ae89d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d158d956d0>]}


============================== 17:28:28.856545 | 288633b1-eff1-425a-bfaa-64e6b5e76401 ==============================
[0m17:28:28.856545 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:28:28.857131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_chicago_crimes', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:28:28.857599 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m17:28:28.858834 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.06335273, "process_in_blocks": "0", "process_kernel_time": 0.129704, "process_mem_max_rss": "96788", "process_out_blocks": "0", "process_user_time": 1.442709}
[0m17:28:28.859474 [debug] [MainThread]: Command `dbt run` failed at 17:28:28.859345 after 0.06 seconds
[0m17:28:28.860027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d158876060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d1588b8950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d158974af0>]}
[0m17:28:28.860538 [debug] [MainThread]: Flushing usage events
[0m17:28:29.370824 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:28:42.656552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770d8428dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770d85ab5d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770d8397d6d0>]}


============================== 17:28:42.660559 | d7410aa5-50c8-4ad5-b5f2-272f7570d3f1 ==============================
[0m17:28:42.660559 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:28:42.661802 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_chicago_crimes', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:28:42.855176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7410aa5-50c8-4ad5-b5f2-272f7570d3f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770d83f80180>]}
[0m17:28:42.926016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7410aa5-50c8-4ad5-b5f2-272f7570d3f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770d83559480>]}
[0m17:28:42.926860 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:28:43.004721 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:28:43.005449 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:28:43.005894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd7410aa5-50c8-4ad5-b5f2-272f7570d3f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770d8351d550>]}
[0m17:28:43.832790 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_chicago_crimes' in the 'models' section of file 'models/schema.yml'
[0m17:28:44.137616 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.analytics_dbt.not_null_stg_chicago_crimes_case_id.fa60758cf3' (models/schema.yml) depends on a node named 'stg_chicago_crimes' in package '' which was not found
[0m17:28:44.138319 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.analytics_dbt.unique_stg_chicago_crimes_case_id.e81af1ae98' (models/schema.yml) depends on a node named 'stg_chicago_crimes' in package '' which was not found
[0m17:28:44.138911 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.analytics_dbt.not_null_stg_chicago_crimes_crime_date.46c013e7a2' (models/schema.yml) depends on a node named 'stg_chicago_crimes' in package '' which was not found
[0m17:28:44.349851 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.analytics_dbt
[0m17:28:44.369749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7410aa5-50c8-4ad5-b5f2-272f7570d3f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770d83534f50>]}
[0m17:28:44.457191 [debug] [MainThread]: Wrote artifact WritableManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/manifest.json
[0m17:28:44.459714 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/semantic_manifest.json
[0m17:28:44.474719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7410aa5-50c8-4ad5-b5f2-272f7570d3f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770d82f46430>]}
[0m17:28:44.475255 [info ] [MainThread]: Found 1 source, 433 macros
[0m17:28:44.475660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7410aa5-50c8-4ad5-b5f2-272f7570d3f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770d827c6680>]}
[0m17:28:44.476326 [warn ] [MainThread]: The selection criterion 'stg_chicago_crimes' does not match any enabled nodes
[0m17:28:44.477802 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:28:44.478502 [debug] [MainThread]: Command end result
[0m17:28:44.507583 [debug] [MainThread]: Wrote artifact WritableManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/manifest.json
[0m17:28:44.509850 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/semantic_manifest.json
[0m17:28:44.514933 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/run_results.json
[0m17:28:44.516620 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9162511, "process_in_blocks": "1728", "process_kernel_time": 0.194645, "process_mem_max_rss": "110536", "process_out_blocks": "2544", "process_user_time": 3.216135}
[0m17:28:44.517331 [debug] [MainThread]: Command `dbt run` succeeded at 17:28:44.517177 after 1.92 seconds
[0m17:28:44.517886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770d8352d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770d823df6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770d823df5f0>]}
[0m17:28:44.518450 [debug] [MainThread]: Flushing usage events
[0m17:28:45.026481 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:31:21.169623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7811ab39dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7811ac9a5d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7811aa8956d0>]}


============================== 17:31:21.173417 | 9c6b62a3-8101-46e9-bc56-60f7671cd66b ==============================
[0m17:31:21.173417 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:31:21.174090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt', 'log_path': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:31:21.318019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c6b62a3-8101-46e9-bc56-60f7671cd66b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7811aae98180>]}
[0m17:31:21.327241 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
        The default package install path has changed from `dbt_modules` to
`dbt_packages`.         Please update `clean-targets` in `dbt_project.yml` and
check `.gitignore` as well.         Or, set `packages-install-path: dbt_modules`
if you'd like to keep the current value.
[0m17:31:21.327902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9c6b62a3-8101-46e9-bc56-60f7671cd66b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7811aa471ae0>]}
[0m17:31:21.332383 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22475415, "process_in_blocks": "16", "process_kernel_time": 0.185543, "process_mem_max_rss": "99064", "process_out_blocks": "16", "process_user_time": 1.647944}
[0m17:31:21.333191 [debug] [MainThread]: Command `dbt clean` succeeded at 17:31:21.333032 after 0.23 seconds
[0m17:31:21.333730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7811aa2ade50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7811aa2add50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7811ab03e210>]}
[0m17:31:21.334296 [debug] [MainThread]: Flushing usage events
[0m17:31:21.848876 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:31:34.609027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed3d1099be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed3d28c5d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed3d078d6d0>]}


============================== 17:31:34.612742 | 662ba6ea-b42b-490a-bb0c-8078008f9ee4 ==============================
[0m17:31:34.612742 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:31:34.613320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_chicago_crimes', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:31:34.798442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '662ba6ea-b42b-490a-bb0c-8078008f9ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed3d0d8c180>]}
[0m17:31:34.868426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '662ba6ea-b42b-490a-bb0c-8078008f9ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed3d0365480>]}
[0m17:31:34.869305 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:31:34.948109 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:31:34.948806 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:31:34.949204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '662ba6ea-b42b-490a-bb0c-8078008f9ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed3cff71550>]}
[0m17:31:36.359693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '662ba6ea-b42b-490a-bb0c-8078008f9ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed3d0343c50>]}
[0m17:31:36.455075 [debug] [MainThread]: Wrote artifact WritableManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/manifest.json
[0m17:31:36.457225 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/semantic_manifest.json
[0m17:31:36.469461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '662ba6ea-b42b-490a-bb0c-8078008f9ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed3cfb48830>]}
[0m17:31:36.469993 [info ] [MainThread]: Found 1 model, 3 data tests, 1 source, 433 macros
[0m17:31:36.470377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '662ba6ea-b42b-490a-bb0c-8078008f9ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed3ce72f930>]}
[0m17:31:36.472218 [info ] [MainThread]: 
[0m17:31:36.472733 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:31:36.473129 [info ] [MainThread]: 
[0m17:31:36.473778 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:31:36.475291 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m17:31:36.525511 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m17:31:36.526161 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m17:31:36.526680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:36.538620 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.012 seconds
[0m17:31:36.540267 [debug] [ThreadPool]: On list_analytics: Close
[0m17:31:36.541281 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_staging)
[0m17:31:36.542040 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "staging"
"
[0m17:31:36.548214 [debug] [ThreadPool]: Using postgres connection "create_analytics_staging"
[0m17:31:36.548673 [debug] [ThreadPool]: On create_analytics_staging: BEGIN
[0m17:31:36.549097 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:31:36.558994 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m17:31:36.559458 [debug] [ThreadPool]: Using postgres connection "create_analytics_staging"
[0m17:31:36.559998 [debug] [ThreadPool]: On create_analytics_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "create_analytics_staging"} */
create schema if not exists "staging"
[0m17:31:36.563212 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.003 seconds
[0m17:31:36.564387 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m17:31:36.564775 [debug] [ThreadPool]: Using postgres connection "create_analytics_staging"
[0m17:31:36.565149 [debug] [ThreadPool]: On create_analytics_staging: COMMIT
[0m17:31:36.566267 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m17:31:36.566645 [debug] [ThreadPool]: On create_analytics_staging: Close
[0m17:31:36.568094 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_staging, now list_analytics_staging)
[0m17:31:36.574116 [debug] [ThreadPool]: Using postgres connection "list_analytics_staging"
[0m17:31:36.574579 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m17:31:36.575087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:31:36.584229 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m17:31:36.584678 [debug] [ThreadPool]: Using postgres connection "list_analytics_staging"
[0m17:31:36.585295 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m17:31:36.589168 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m17:31:36.590576 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m17:31:36.591232 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m17:31:36.598044 [debug] [MainThread]: Using postgres connection "master"
[0m17:31:36.598484 [debug] [MainThread]: On master: BEGIN
[0m17:31:36.598852 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:31:36.607679 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m17:31:36.608341 [debug] [MainThread]: Using postgres connection "master"
[0m17:31:36.609366 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:31:36.618160 [debug] [MainThread]: SQL status: SELECT 29 in 0.008 seconds
[0m17:31:36.620503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '662ba6ea-b42b-490a-bb0c-8078008f9ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed3ce789850>]}
[0m17:31:36.621100 [debug] [MainThread]: On master: ROLLBACK
[0m17:31:36.621866 [debug] [MainThread]: Using postgres connection "master"
[0m17:31:36.622372 [debug] [MainThread]: On master: BEGIN
[0m17:31:36.623202 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:31:36.623584 [debug] [MainThread]: On master: COMMIT
[0m17:31:36.624178 [debug] [MainThread]: Using postgres connection "master"
[0m17:31:36.624601 [debug] [MainThread]: On master: COMMIT
[0m17:31:36.625327 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:31:36.625725 [debug] [MainThread]: On master: Close
[0m17:31:36.629126 [debug] [Thread-1 (]: Began running node model.analytics_dbt.stg_chicago_crimes
[0m17:31:36.630054 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_chicago_crimes ......................... [RUN]
[0m17:31:36.630714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.analytics_dbt.stg_chicago_crimes)
[0m17:31:36.631480 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.stg_chicago_crimes
[0m17:31:36.646306 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.stg_chicago_crimes"
[0m17:31:36.647241 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.stg_chicago_crimes
[0m17:31:36.695736 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.stg_chicago_crimes"
[0m17:31:36.696980 [debug] [Thread-1 (]: Using postgres connection "model.analytics_dbt.stg_chicago_crimes"
[0m17:31:36.697391 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: BEGIN
[0m17:31:36.697779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:36.707891 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m17:31:36.708580 [debug] [Thread-1 (]: Using postgres connection "model.analytics_dbt.stg_chicago_crimes"
[0m17:31:36.709018 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.stg_chicago_crimes"} */

  create view "analytics"."staging"."stg_chicago_crimes__dbt_tmp"
    
    
  as (
    -- models/staging/stg_chicago_crimes.sql



with raw as (
  select * from "analytics"."public"."raw_chicago_crimes"
)

select
  case_number::varchar       as case_id,
  to_timestamp(year || '-' || lpad(month::text,2,'0') || '-' || lpad(day::text,2,'0') 
    || ' ' || lpad(hour::text,2,'0') || ':' || lpad(minute::text,2,'0') 
    , 'YYYY-MM-DD HH24:MI')  as event_datetime,
  date(to_timestamp(year || '-' || lpad(month::text,2,'0') || '-' || lpad(day::text,2,'0') 
    || ' ' || lpad(hour::text,2,'0') || ':' || lpad(minute::text,2,'0') 
    , 'YYYY-MM-DD HH24:MI')) as crime_date,
  primary_type               as crime_type,
  description,
  location_description       as location,
  (arrest = 'true')          as is_arrest,
  (domestic = 'true')        as is_domestic
from raw
;
  );
[0m17:31:36.711199 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 29: ;
         ^

[0m17:31:36.711683 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: ROLLBACK
[0m17:31:36.712543 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: Close
[0m17:31:36.725224 [debug] [Thread-1 (]: Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  syntax error at or near ";"
  LINE 29: ;
           ^
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql
[0m17:31:36.727273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '662ba6ea-b42b-490a-bb0c-8078008f9ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed3ceb83ac0>]}
[0m17:31:36.728060 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model staging.stg_chicago_crimes ................ [[31mERROR[0m in 0.10s]
[0m17:31:36.728725 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.stg_chicago_crimes
[0m17:31:36.729389 [debug] [Thread-4 (]: Marking all children of 'model.analytics_dbt.stg_chicago_crimes' to be skipped because of status 'error'.  Reason: Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  syntax error at or near ";"
  LINE 29: ;
           ^
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql.
[0m17:31:36.732136 [debug] [MainThread]: Using postgres connection "master"
[0m17:31:36.732796 [debug] [MainThread]: On master: BEGIN
[0m17:31:36.733168 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:31:36.745718 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m17:31:36.746437 [debug] [MainThread]: On master: COMMIT
[0m17:31:36.747036 [debug] [MainThread]: Using postgres connection "master"
[0m17:31:36.747634 [debug] [MainThread]: On master: COMMIT
[0m17:31:36.748734 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:31:36.749422 [debug] [MainThread]: On master: Close
[0m17:31:36.750417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:31:36.750870 [debug] [MainThread]: Connection 'model.analytics_dbt.stg_chicago_crimes' was properly closed.
[0m17:31:36.751295 [info ] [MainThread]: 
[0m17:31:36.751750 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m17:31:36.752618 [debug] [MainThread]: Command end result
[0m17:31:36.775272 [debug] [MainThread]: Wrote artifact WritableManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/manifest.json
[0m17:31:36.778124 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/semantic_manifest.json
[0m17:31:36.787117 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/run_results.json
[0m17:31:36.787611 [info ] [MainThread]: 
[0m17:31:36.788217 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:31:36.788693 [info ] [MainThread]: 
[0m17:31:36.789433 [error] [MainThread]:   Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  syntax error at or near ";"
  LINE 29: ;
           ^
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql
[0m17:31:36.789850 [info ] [MainThread]: 
[0m17:31:36.790353 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:31:36.791673 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.239708, "process_in_blocks": "1128", "process_kernel_time": 0.217088, "process_mem_max_rss": "120624", "process_out_blocks": "2608", "process_user_time": 3.483422}
[0m17:31:36.792291 [debug] [MainThread]: Command `dbt run` failed at 17:31:36.792144 after 2.24 seconds
[0m17:31:36.792870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed3cc538910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed3cc507020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed3d13b94d0>]}
[0m17:31:36.793377 [debug] [MainThread]: Flushing usage events
[0m17:31:37.308527 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:34:59.309344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711bb63a9be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711bb79e9d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711bb58a56d0>]}


============================== 17:34:59.312885 | 4b97f0f7-8399-489f-bd3f-5bc951d17dbf ==============================
[0m17:34:59.312885 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:34:59.313906 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:34:59.448280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b97f0f7-8399-489f-bd3f-5bc951d17dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711bb5ea4180>]}
[0m17:34:59.457489 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
        The default package install path has changed from `dbt_modules` to
`dbt_packages`.         Please update `clean-targets` in `dbt_project.yml` and
check `.gitignore` as well.         Or, set `packages-install-path: dbt_modules`
if you'd like to keep the current value.
[0m17:34:59.458130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4b97f0f7-8399-489f-bd3f-5bc951d17dbf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711bb5481ae0>]}
[0m17:34:59.463109 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22205874, "process_in_blocks": "0", "process_kernel_time": 0.140703, "process_mem_max_rss": "99168", "process_out_blocks": "16", "process_user_time": 1.567695}
[0m17:34:59.464165 [debug] [MainThread]: Command `dbt clean` succeeded at 17:34:59.463909 after 0.22 seconds
[0m17:34:59.465458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711bb52b9e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711bb52b9d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711bb604a210>]}
[0m17:34:59.466570 [debug] [MainThread]: Flushing usage events
[0m17:35:00.019240 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:35:11.028758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e00faca9be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e00fc38dd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e00fa1a56d0>]}


============================== 17:35:11.032515 | 4d4b9d0c-cda4-4e37-a5a0-504e918872e8 ==============================
[0m17:35:11.032515 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:35:11.033287 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_chicago_crimes', 'send_anonymous_usage_stats': 'True'}
[0m17:35:11.215289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d4b9d0c-cda4-4e37-a5a0-504e918872e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e00fa7a4180>]}
[0m17:35:11.285867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d4b9d0c-cda4-4e37-a5a0-504e918872e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e00f9d7d480>]}
[0m17:35:11.286907 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:35:11.367088 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:35:11.367875 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:35:11.368271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4d4b9d0c-cda4-4e37-a5a0-504e918872e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e00f9719550>]}
[0m17:35:12.770421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d4b9d0c-cda4-4e37-a5a0-504e918872e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e00f9d5bc50>]}
[0m17:35:12.867089 [debug] [MainThread]: Wrote artifact WritableManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/manifest.json
[0m17:35:12.869291 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/semantic_manifest.json
[0m17:35:12.881604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d4b9d0c-cda4-4e37-a5a0-504e918872e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e00f935c830>]}
[0m17:35:12.882249 [info ] [MainThread]: Found 1 model, 3 data tests, 1 source, 433 macros
[0m17:35:12.882684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d4b9d0c-cda4-4e37-a5a0-504e918872e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e00f7f43930>]}
[0m17:35:12.885204 [info ] [MainThread]: 
[0m17:35:12.885903 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:35:12.886369 [info ] [MainThread]: 
[0m17:35:12.887207 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:35:12.888719 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m17:35:12.939812 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m17:35:12.940765 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m17:35:12.941495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:12.953993 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m17:35:12.955805 [debug] [ThreadPool]: On list_analytics: Close
[0m17:35:12.957469 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_staging)
[0m17:35:12.964195 [debug] [ThreadPool]: Using postgres connection "list_analytics_staging"
[0m17:35:12.964705 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m17:35:12.965193 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:35:12.975116 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m17:35:12.975599 [debug] [ThreadPool]: Using postgres connection "list_analytics_staging"
[0m17:35:12.976041 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m17:35:12.980534 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m17:35:12.982285 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m17:35:12.982999 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m17:35:12.988852 [debug] [MainThread]: Using postgres connection "master"
[0m17:35:12.989439 [debug] [MainThread]: On master: BEGIN
[0m17:35:12.990035 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:35:13.002059 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m17:35:13.002657 [debug] [MainThread]: Using postgres connection "master"
[0m17:35:13.003461 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:35:13.013827 [debug] [MainThread]: SQL status: SELECT 29 in 0.010 seconds
[0m17:35:13.016738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d4b9d0c-cda4-4e37-a5a0-504e918872e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e00f7f9da90>]}
[0m17:35:13.017649 [debug] [MainThread]: On master: ROLLBACK
[0m17:35:13.018511 [debug] [MainThread]: Using postgres connection "master"
[0m17:35:13.018977 [debug] [MainThread]: On master: BEGIN
[0m17:35:13.019971 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:35:13.020425 [debug] [MainThread]: On master: COMMIT
[0m17:35:13.020855 [debug] [MainThread]: Using postgres connection "master"
[0m17:35:13.021241 [debug] [MainThread]: On master: COMMIT
[0m17:35:13.021871 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:35:13.022300 [debug] [MainThread]: On master: Close
[0m17:35:13.025051 [debug] [Thread-1 (]: Began running node model.analytics_dbt.stg_chicago_crimes
[0m17:35:13.025778 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_chicago_crimes ......................... [RUN]
[0m17:35:13.026476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.analytics_dbt.stg_chicago_crimes)
[0m17:35:13.026993 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.stg_chicago_crimes
[0m17:35:13.039461 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.stg_chicago_crimes"
[0m17:35:13.040655 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.stg_chicago_crimes
[0m17:35:13.091117 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.stg_chicago_crimes"
[0m17:35:13.092289 [debug] [Thread-1 (]: Using postgres connection "model.analytics_dbt.stg_chicago_crimes"
[0m17:35:13.092784 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: BEGIN
[0m17:35:13.093205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:13.102292 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m17:35:13.102816 [debug] [Thread-1 (]: Using postgres connection "model.analytics_dbt.stg_chicago_crimes"
[0m17:35:13.103260 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.stg_chicago_crimes"} */

  create view "analytics"."staging"."stg_chicago_crimes__dbt_tmp"
    
    
  as (
    -- models/staging/stg_chicago_crimes.sql


with raw as (
  select * from "analytics"."public"."raw_chicago_crimes"
)

select
  case_number::varchar       as case_id,
  event_datetime              as event_datetime,
  date(event_datetime)        as crime_date,
  primary_type                as crime_type,
  description,
  location_description        as location,
  (arrest = 'true')           as is_arrest,
  (domestic = 'true')         as is_domestic
from raw
  );
[0m17:35:13.104609 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.raw_chicago_crimes" does not exist
LINE 11:   select * from "analytics"."public"."raw_chicago_crimes"
                         ^

[0m17:35:13.105354 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: ROLLBACK
[0m17:35:13.106321 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: Close
[0m17:35:13.113719 [debug] [Thread-1 (]: Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  relation "public.raw_chicago_crimes" does not exist
  LINE 11:   select * from "analytics"."public"."raw_chicago_crimes"
                           ^
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql
[0m17:35:13.115541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d4b9d0c-cda4-4e37-a5a0-504e918872e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e00f8397a10>]}
[0m17:35:13.116284 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model staging.stg_chicago_crimes ................ [[31mERROR[0m in 0.09s]
[0m17:35:13.117065 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.stg_chicago_crimes
[0m17:35:13.117813 [debug] [Thread-4 (]: Marking all children of 'model.analytics_dbt.stg_chicago_crimes' to be skipped because of status 'error'.  Reason: Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  relation "public.raw_chicago_crimes" does not exist
  LINE 11:   select * from "analytics"."public"."raw_chicago_crimes"
                           ^
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql.
[0m17:35:13.121642 [debug] [MainThread]: Using postgres connection "master"
[0m17:35:13.122457 [debug] [MainThread]: On master: BEGIN
[0m17:35:13.123108 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:35:13.140138 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m17:35:13.141022 [debug] [MainThread]: On master: COMMIT
[0m17:35:13.141677 [debug] [MainThread]: Using postgres connection "master"
[0m17:35:13.142160 [debug] [MainThread]: On master: COMMIT
[0m17:35:13.142988 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:35:13.143485 [debug] [MainThread]: On master: Close
[0m17:35:13.144172 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:35:13.144619 [debug] [MainThread]: Connection 'model.analytics_dbt.stg_chicago_crimes' was properly closed.
[0m17:35:13.145291 [info ] [MainThread]: 
[0m17:35:13.145806 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m17:35:13.146865 [debug] [MainThread]: Command end result
[0m17:35:13.176010 [debug] [MainThread]: Wrote artifact WritableManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/manifest.json
[0m17:35:13.178413 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/semantic_manifest.json
[0m17:35:13.186760 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/run_results.json
[0m17:35:13.187341 [info ] [MainThread]: 
[0m17:35:13.187865 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:35:13.188440 [info ] [MainThread]: 
[0m17:35:13.189151 [error] [MainThread]:   Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  relation "public.raw_chicago_crimes" does not exist
  LINE 11:   select * from "analytics"."public"."raw_chicago_crimes"
                           ^
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql
[0m17:35:13.189909 [info ] [MainThread]: 
[0m17:35:13.190626 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:35:13.192405 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.227398, "process_in_blocks": "0", "process_kernel_time": 0.236378, "process_mem_max_rss": "120724", "process_out_blocks": "2600", "process_user_time": 3.522732}
[0m17:35:13.193359 [debug] [MainThread]: Command `dbt run` failed at 17:35:13.193186 after 2.23 seconds
[0m17:35:13.193988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e00f600b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e00f601a960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e00fade54d0>]}
[0m17:35:13.194530 [debug] [MainThread]: Flushing usage events
[0m17:35:13.735538 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:15:09.241054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70977429dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709775a89d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7097739716d0>]}


============================== 09:15:09.246905 | c4953cbd-e633-4236-9517-d60f9abadd27 ==============================
[0m09:15:09.246905 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:15:09.247596 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:15:09.497863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4953cbd-e633-4236-9517-d60f9abadd27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709773f70180>]}
[0m09:15:09.574138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4953cbd-e633-4236-9517-d60f9abadd27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709773549480>]}
[0m09:15:09.575425 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:15:09.672860 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:15:09.838043 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:15:09.838755 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/stg_chicago_crimes.sql
[0m09:15:10.363054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4953cbd-e633-4236-9517-d60f9abadd27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70977210d050>]}
[0m09:15:10.455503 [debug] [MainThread]: Wrote artifact WritableManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/manifest.json
[0m09:15:10.458543 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/semantic_manifest.json
[0m09:15:10.481911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4953cbd-e633-4236-9517-d60f9abadd27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709772165220>]}
[0m09:15:10.482438 [info ] [MainThread]: Found 1 model, 3 data tests, 1 source, 433 macros
[0m09:15:10.482824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4953cbd-e633-4236-9517-d60f9abadd27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7097719c9550>]}
[0m09:15:10.485225 [info ] [MainThread]: 
[0m09:15:10.486018 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:15:10.486440 [info ] [MainThread]: 
[0m09:15:10.487229 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:15:10.488754 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m09:15:10.569204 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m09:15:10.569786 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m09:15:10.570260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:15:10.596203 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.026 seconds
[0m09:15:10.599014 [debug] [ThreadPool]: On list_analytics: Close
[0m09:15:10.601250 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_staging)
[0m09:15:10.614453 [debug] [ThreadPool]: Using postgres connection "list_analytics_staging"
[0m09:15:10.615048 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m09:15:10.615481 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:15:10.628385 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m09:15:10.629166 [debug] [ThreadPool]: Using postgres connection "list_analytics_staging"
[0m09:15:10.629656 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m09:15:10.640103 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m09:15:10.641954 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m09:15:10.642880 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m09:15:10.649243 [debug] [MainThread]: Using postgres connection "master"
[0m09:15:10.649756 [debug] [MainThread]: On master: BEGIN
[0m09:15:10.650175 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:15:10.660962 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m09:15:10.661499 [debug] [MainThread]: Using postgres connection "master"
[0m09:15:10.662037 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:15:10.674132 [debug] [MainThread]: SQL status: SELECT 29 in 0.011 seconds
[0m09:15:10.676762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4953cbd-e633-4236-9517-d60f9abadd27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709770119570>]}
[0m09:15:10.677825 [debug] [MainThread]: On master: ROLLBACK
[0m09:15:10.678619 [debug] [MainThread]: Using postgres connection "master"
[0m09:15:10.679061 [debug] [MainThread]: On master: BEGIN
[0m09:15:10.679961 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:15:10.680383 [debug] [MainThread]: On master: COMMIT
[0m09:15:10.680783 [debug] [MainThread]: Using postgres connection "master"
[0m09:15:10.681173 [debug] [MainThread]: On master: COMMIT
[0m09:15:10.681857 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:15:10.682290 [debug] [MainThread]: On master: Close
[0m09:15:10.685852 [debug] [Thread-1 (]: Began running node model.analytics_dbt.stg_chicago_crimes
[0m09:15:10.686569 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_chicago_crimes ......................... [RUN]
[0m09:15:10.687164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.analytics_dbt.stg_chicago_crimes)
[0m09:15:10.687611 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.stg_chicago_crimes
[0m09:15:10.698616 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.stg_chicago_crimes"
[0m09:15:10.699778 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.stg_chicago_crimes
[0m09:15:10.758825 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.stg_chicago_crimes"
[0m09:15:10.759798 [debug] [Thread-1 (]: Using postgres connection "model.analytics_dbt.stg_chicago_crimes"
[0m09:15:10.760303 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: BEGIN
[0m09:15:10.760787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:15:10.771394 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m09:15:10.772264 [debug] [Thread-1 (]: Using postgres connection "model.analytics_dbt.stg_chicago_crimes"
[0m09:15:10.773159 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.stg_chicago_crimes"} */

  create view "analytics"."staging"."stg_chicago_crimes__dbt_tmp"
    
    
  as (
    -- models/staging/stg_chicago_crimes.sql


with raw as (
  select * from "analytics"."staging"."raw_chicago_crimes"
)

select
  case_number::varchar       as case_id,
  event_datetime              as event_datetime,
  date(event_datetime)        as crime_date,
  primary_type                as crime_type,
  description,
  location_description        as location,
  (arrest = 'true')           as is_arrest,
  (domestic = 'true')         as is_domestic
from raw
  );
[0m09:15:10.776003 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "case_number" does not exist
LINE 15:   case_number::varchar       as case_id,
           ^
HINT:  Perhaps you meant to reference the column "raw.Case_Number".

[0m09:15:10.776500 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: ROLLBACK
[0m09:15:10.777633 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: Close
[0m09:15:10.789853 [debug] [Thread-1 (]: Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column "case_number" does not exist
  LINE 15:   case_number::varchar       as case_id,
             ^
  HINT:  Perhaps you meant to reference the column "raw.Case_Number".
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql
[0m09:15:10.792005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4953cbd-e633-4236-9517-d60f9abadd27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7097719d2a50>]}
[0m09:15:10.792756 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model staging.stg_chicago_crimes ................ [[31mERROR[0m in 0.10s]
[0m09:15:10.793492 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.stg_chicago_crimes
[0m09:15:10.794339 [debug] [Thread-4 (]: Marking all children of 'model.analytics_dbt.stg_chicago_crimes' to be skipped because of status 'error'.  Reason: Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column "case_number" does not exist
  LINE 15:   case_number::varchar       as case_id,
             ^
  HINT:  Perhaps you meant to reference the column "raw.Case_Number".
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql.
[0m09:15:10.797356 [debug] [MainThread]: Using postgres connection "master"
[0m09:15:10.798048 [debug] [MainThread]: On master: BEGIN
[0m09:15:10.798455 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:15:10.811221 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m09:15:10.811967 [debug] [MainThread]: On master: COMMIT
[0m09:15:10.812564 [debug] [MainThread]: Using postgres connection "master"
[0m09:15:10.813125 [debug] [MainThread]: On master: COMMIT
[0m09:15:10.813965 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:15:10.814503 [debug] [MainThread]: On master: Close
[0m09:15:10.815409 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:15:10.815958 [debug] [MainThread]: Connection 'model.analytics_dbt.stg_chicago_crimes' was properly closed.
[0m09:15:10.816487 [info ] [MainThread]: 
[0m09:15:10.817152 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m09:15:10.818389 [debug] [MainThread]: Command end result
[0m09:15:10.958569 [debug] [MainThread]: Wrote artifact WritableManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/manifest.json
[0m09:15:10.961846 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/semantic_manifest.json
[0m09:15:10.973999 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/run_results.json
[0m09:15:10.974854 [info ] [MainThread]: 
[0m09:15:10.975805 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:15:10.976942 [info ] [MainThread]: 
[0m09:15:10.978123 [error] [MainThread]:   Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column "case_number" does not exist
  LINE 15:   case_number::varchar       as case_id,
             ^
  HINT:  Perhaps you meant to reference the column "raw.Case_Number".
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql
[0m09:15:10.978828 [info ] [MainThread]: 
[0m09:15:10.979455 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:15:10.982506 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8012072, "process_in_blocks": "81032", "process_kernel_time": 0.332219, "process_mem_max_rss": "120852", "process_out_blocks": "2608", "process_user_time": 3.125836}
[0m09:15:10.983622 [debug] [MainThread]: Command `dbt run` failed at 09:15:10.983419 after 1.80 seconds
[0m09:15:10.984586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7097711e8cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709771db87d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709771db8190>]}
[0m09:15:10.985636 [debug] [MainThread]: Flushing usage events
[0m09:15:11.983754 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:15:46.597728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b5943a5be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b5959f5d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b5938b56d0>]}


============================== 09:15:46.602822 | 3244b2ee-207a-48d6-8639-98abf8883675 ==============================
[0m09:15:46.602822 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:15:46.603442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:15:46.817294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3244b2ee-207a-48d6-8639-98abf8883675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b593eb4180>]}
[0m09:15:46.892956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3244b2ee-207a-48d6-8639-98abf8883675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b59348d480>]}
[0m09:15:46.894217 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:15:46.984993 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:15:47.142445 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:15:47.143343 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/stg_chicago_crimes.sql
[0m09:15:47.666715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3244b2ee-207a-48d6-8639-98abf8883675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b591d4d050>]}
[0m09:15:47.757300 [debug] [MainThread]: Wrote artifact WritableManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/manifest.json
[0m09:15:47.759982 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/semantic_manifest.json
[0m09:15:47.782278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3244b2ee-207a-48d6-8639-98abf8883675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b591da5220>]}
[0m09:15:47.782823 [info ] [MainThread]: Found 1 model, 3 data tests, 1 source, 433 macros
[0m09:15:47.783291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3244b2ee-207a-48d6-8639-98abf8883675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b591121550>]}
[0m09:15:47.785669 [info ] [MainThread]: 
[0m09:15:47.786262 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:15:47.786650 [info ] [MainThread]: 
[0m09:15:47.787493 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:15:47.789044 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m09:15:47.857283 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m09:15:47.857882 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m09:15:47.858351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:15:47.872145 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.014 seconds
[0m09:15:47.874018 [debug] [ThreadPool]: On list_analytics: Close
[0m09:15:47.875659 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_staging)
[0m09:15:47.883898 [debug] [ThreadPool]: Using postgres connection "list_analytics_staging"
[0m09:15:47.884461 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m09:15:47.885074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:15:47.897138 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m09:15:47.898050 [debug] [ThreadPool]: Using postgres connection "list_analytics_staging"
[0m09:15:47.898578 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m09:15:47.903879 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m09:15:47.905660 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m09:15:47.906455 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m09:15:47.911482 [debug] [MainThread]: Using postgres connection "master"
[0m09:15:47.911946 [debug] [MainThread]: On master: BEGIN
[0m09:15:47.912319 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:15:47.924170 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m09:15:47.924903 [debug] [MainThread]: Using postgres connection "master"
[0m09:15:47.925389 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:15:47.934807 [debug] [MainThread]: SQL status: SELECT 29 in 0.009 seconds
[0m09:15:47.937373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3244b2ee-207a-48d6-8639-98abf8883675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b58b361570>]}
[0m09:15:47.938029 [debug] [MainThread]: On master: ROLLBACK
[0m09:15:47.939005 [debug] [MainThread]: Using postgres connection "master"
[0m09:15:47.939712 [debug] [MainThread]: On master: BEGIN
[0m09:15:47.940764 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:15:47.941227 [debug] [MainThread]: On master: COMMIT
[0m09:15:47.941628 [debug] [MainThread]: Using postgres connection "master"
[0m09:15:47.942032 [debug] [MainThread]: On master: COMMIT
[0m09:15:47.942661 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:15:47.943185 [debug] [MainThread]: On master: Close
[0m09:15:47.946199 [debug] [Thread-1 (]: Began running node model.analytics_dbt.stg_chicago_crimes
[0m09:15:47.946996 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_chicago_crimes ......................... [RUN]
[0m09:15:47.947787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.analytics_dbt.stg_chicago_crimes)
[0m09:15:47.948702 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.stg_chicago_crimes
[0m09:15:47.967641 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.stg_chicago_crimes"
[0m09:15:47.968981 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.stg_chicago_crimes
[0m09:15:48.026510 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.stg_chicago_crimes"
[0m09:15:48.027458 [debug] [Thread-1 (]: Using postgres connection "model.analytics_dbt.stg_chicago_crimes"
[0m09:15:48.027869 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: BEGIN
[0m09:15:48.028293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:15:48.039172 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m09:15:48.040097 [debug] [Thread-1 (]: Using postgres connection "model.analytics_dbt.stg_chicago_crimes"
[0m09:15:48.041064 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.stg_chicago_crimes"} */

  create view "analytics"."staging"."stg_chicago_crimes__dbt_tmp"
    
    
  as (
    -- models/staging/stg_chicago_crimes.sql


with raw as (
  select * from "analytics"."staging"."raw_chicago_crimes"
)

select
  Case_Number::varchar       as case_id,
  event_datetime              as event_datetime,
  date(event_datetime)        as crime_date,
  primary_type                as crime_type,
  description,
  location_description        as location,
  (arrest = 'true')           as is_arrest,
  (domestic = 'true')         as is_domestic
from raw
  );
[0m09:15:48.042966 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "case_number" does not exist
LINE 15:   Case_Number::varchar       as case_id,
           ^
HINT:  Perhaps you meant to reference the column "raw.Case_Number".

[0m09:15:48.043553 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: ROLLBACK
[0m09:15:48.045541 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: Close
[0m09:15:48.057947 [debug] [Thread-1 (]: Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column "case_number" does not exist
  LINE 15:   Case_Number::varchar       as case_id,
             ^
  HINT:  Perhaps you meant to reference the column "raw.Case_Number".
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql
[0m09:15:48.060182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3244b2ee-207a-48d6-8639-98abf8883675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b59112aa50>]}
[0m09:15:48.061039 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model staging.stg_chicago_crimes ................ [[31mERROR[0m in 0.11s]
[0m09:15:48.061800 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.stg_chicago_crimes
[0m09:15:48.062949 [debug] [Thread-4 (]: Marking all children of 'model.analytics_dbt.stg_chicago_crimes' to be skipped because of status 'error'.  Reason: Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column "case_number" does not exist
  LINE 15:   Case_Number::varchar       as case_id,
             ^
  HINT:  Perhaps you meant to reference the column "raw.Case_Number".
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql.
[0m09:15:48.066498 [debug] [MainThread]: Using postgres connection "master"
[0m09:15:48.067523 [debug] [MainThread]: On master: BEGIN
[0m09:15:48.068164 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:15:48.081885 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m09:15:48.082653 [debug] [MainThread]: On master: COMMIT
[0m09:15:48.083330 [debug] [MainThread]: Using postgres connection "master"
[0m09:15:48.083781 [debug] [MainThread]: On master: COMMIT
[0m09:15:48.084982 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:15:48.085641 [debug] [MainThread]: On master: Close
[0m09:15:48.086635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:15:48.087271 [debug] [MainThread]: Connection 'model.analytics_dbt.stg_chicago_crimes' was properly closed.
[0m09:15:48.087806 [info ] [MainThread]: 
[0m09:15:48.088406 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m09:15:48.090603 [debug] [MainThread]: Command end result
[0m09:15:48.245834 [debug] [MainThread]: Wrote artifact WritableManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/manifest.json
[0m09:15:48.248439 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/semantic_manifest.json
[0m09:15:48.256435 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/run_results.json
[0m09:15:48.257098 [info ] [MainThread]: 
[0m09:15:48.257647 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:15:48.258197 [info ] [MainThread]: 
[0m09:15:48.258878 [error] [MainThread]:   Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column "case_number" does not exist
  LINE 15:   Case_Number::varchar       as case_id,
             ^
  HINT:  Perhaps you meant to reference the column "raw.Case_Number".
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql
[0m09:15:48.259396 [info ] [MainThread]: 
[0m09:15:48.259945 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:15:48.261999 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7272302, "process_in_blocks": "33992", "process_kernel_time": 0.26469, "process_mem_max_rss": "121392", "process_out_blocks": "2608", "process_user_time": 3.236979}
[0m09:15:48.262849 [debug] [MainThread]: Command `dbt run` failed at 09:15:48.262653 after 1.73 seconds
[0m09:15:48.263495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b58b32ccb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b5919e47d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b5919e4190>]}
[0m09:15:48.264220 [debug] [MainThread]: Flushing usage events
[0m09:15:48.777282 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:55:42.186327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d074159dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0742c85d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0740a996d0>]}


============================== 09:55:42.194261 | 09143b97-ffc4-43e2-82d8-0f50f835f5e2 ==============================
[0m09:55:42.194261 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:55:42.195156 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:55:42.416516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09143b97-ffc4-43e2-82d8-0f50f835f5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0741098180>]}
[0m09:55:42.487134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09143b97-ffc4-43e2-82d8-0f50f835f5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0740671480>]}
[0m09:55:42.488412 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:55:42.585222 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:55:42.691361 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m09:55:42.691973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '09143b97-ffc4-43e2-82d8-0f50f835f5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d074032bc50>]}
[0m09:55:44.145907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09143b97-ffc4-43e2-82d8-0f50f835f5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d073fbf7890>]}
[0m09:55:44.233405 [debug] [MainThread]: Wrote artifact WritableManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/manifest.json
[0m09:55:44.236852 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/semantic_manifest.json
[0m09:55:44.259708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09143b97-ffc4-43e2-82d8-0f50f835f5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d07403e7930>]}
[0m09:55:44.260562 [info ] [MainThread]: Found 1 model, 3 data tests, 1 source, 433 macros
[0m09:55:44.261332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09143b97-ffc4-43e2-82d8-0f50f835f5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d07405efad0>]}
[0m09:55:44.264907 [info ] [MainThread]: 
[0m09:55:44.265508 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:55:44.265907 [info ] [MainThread]: 
[0m09:55:44.266599 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:55:44.268278 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m09:55:44.343670 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m09:55:44.344294 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m09:55:44.344755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:44.358163 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.013 seconds
[0m09:55:44.360238 [debug] [ThreadPool]: On list_analytics: Close
[0m09:55:44.361835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_staging)
[0m09:55:44.368871 [debug] [ThreadPool]: Using postgres connection "list_analytics_staging"
[0m09:55:44.369400 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m09:55:44.369793 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:55:44.382052 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m09:55:44.382817 [debug] [ThreadPool]: Using postgres connection "list_analytics_staging"
[0m09:55:44.383571 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m09:55:44.388872 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m09:55:44.390528 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m09:55:44.391278 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m09:55:44.396608 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:44.397400 [debug] [MainThread]: On master: BEGIN
[0m09:55:44.397944 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:55:44.410473 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m09:55:44.410992 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:44.411521 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:55:44.421098 [debug] [MainThread]: SQL status: SELECT 29 in 0.009 seconds
[0m09:55:44.423259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09143b97-ffc4-43e2-82d8-0f50f835f5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d073eb59d90>]}
[0m09:55:44.423871 [debug] [MainThread]: On master: ROLLBACK
[0m09:55:44.424621 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:44.425150 [debug] [MainThread]: On master: BEGIN
[0m09:55:44.426023 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:55:44.426484 [debug] [MainThread]: On master: COMMIT
[0m09:55:44.427094 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:44.427485 [debug] [MainThread]: On master: COMMIT
[0m09:55:44.428290 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:55:44.428739 [debug] [MainThread]: On master: Close
[0m09:55:44.432046 [debug] [Thread-1 (]: Began running node model.analytics_dbt.stg_chicago_crimes
[0m09:55:44.432897 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_chicago_crimes ......................... [RUN]
[0m09:55:44.433703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.analytics_dbt.stg_chicago_crimes)
[0m09:55:44.434628 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.stg_chicago_crimes
[0m09:55:44.454941 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.stg_chicago_crimes"
[0m09:55:44.456175 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.stg_chicago_crimes
[0m09:55:44.509770 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.stg_chicago_crimes"
[0m09:55:44.510705 [debug] [Thread-1 (]: Using postgres connection "model.analytics_dbt.stg_chicago_crimes"
[0m09:55:44.511530 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: BEGIN
[0m09:55:44.512259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:44.522960 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m09:55:44.523775 [debug] [Thread-1 (]: Using postgres connection "model.analytics_dbt.stg_chicago_crimes"
[0m09:55:44.524666 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.stg_chicago_crimes"} */

  create view "analytics"."staging"."stg_chicago_crimes__dbt_tmp"
    
    
  as (
    -- models/staging/stg_chicago_crimes.sql


with raw as (
  select * from "analytics"."staging"."raw_chicago_crimes"
)

select
  Case_Number::varchar       as case_id,
  event_datetime              as event_datetime,
  date(event_datetime)        as crime_date,
  primary_type                as crime_type,
  description,
  location_description        as location,
  (arrest = 'true')           as is_arrest,
  (domestic = 'true')         as is_domestic
from raw
  );
[0m09:55:44.526131 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "case_number" does not exist
LINE 15:   Case_Number::varchar       as case_id,
           ^
HINT:  Perhaps you meant to reference the column "raw.Case_Number".

[0m09:55:44.526678 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: ROLLBACK
[0m09:55:44.527448 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: Close
[0m09:55:44.538448 [debug] [Thread-1 (]: Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column "case_number" does not exist
  LINE 15:   Case_Number::varchar       as case_id,
             ^
  HINT:  Perhaps you meant to reference the column "raw.Case_Number".
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql
[0m09:55:44.540682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09143b97-ffc4-43e2-82d8-0f50f835f5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d073e365700>]}
[0m09:55:44.541487 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model staging.stg_chicago_crimes ................ [[31mERROR[0m in 0.11s]
[0m09:55:44.542286 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.stg_chicago_crimes
[0m09:55:44.543148 [debug] [Thread-4 (]: Marking all children of 'model.analytics_dbt.stg_chicago_crimes' to be skipped because of status 'error'.  Reason: Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column "case_number" does not exist
  LINE 15:   Case_Number::varchar       as case_id,
             ^
  HINT:  Perhaps you meant to reference the column "raw.Case_Number".
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql.
[0m09:55:44.546492 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:44.547605 [debug] [MainThread]: On master: BEGIN
[0m09:55:44.548553 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:55:44.564318 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m09:55:44.565369 [debug] [MainThread]: On master: COMMIT
[0m09:55:44.565947 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:44.566422 [debug] [MainThread]: On master: COMMIT
[0m09:55:44.567634 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:55:44.568598 [debug] [MainThread]: On master: Close
[0m09:55:44.570168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:55:44.571611 [debug] [MainThread]: Connection 'model.analytics_dbt.stg_chicago_crimes' was properly closed.
[0m09:55:44.572830 [info ] [MainThread]: 
[0m09:55:44.574058 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m09:55:44.575872 [debug] [MainThread]: Command end result
[0m09:55:44.603198 [debug] [MainThread]: Wrote artifact WritableManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/manifest.json
[0m09:55:44.605669 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/semantic_manifest.json
[0m09:55:44.616509 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/run_results.json
[0m09:55:44.617454 [info ] [MainThread]: 
[0m09:55:44.618460 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:55:44.619200 [info ] [MainThread]: 
[0m09:55:44.619804 [error] [MainThread]:   Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column "case_number" does not exist
  LINE 15:   Case_Number::varchar       as case_id,
             ^
  HINT:  Perhaps you meant to reference the column "raw.Case_Number".
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql
[0m09:55:44.620307 [info ] [MainThread]: 
[0m09:55:44.620815 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:55:44.622789 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.5057232, "process_in_blocks": "6456", "process_kernel_time": 0.246015, "process_mem_max_rss": "120792", "process_out_blocks": "2608", "process_user_time": 4.095261}
[0m09:55:44.623546 [debug] [MainThread]: Command `dbt run` failed at 09:55:44.623383 after 2.51 seconds
[0m09:55:44.624144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d073c97ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d073eb8fe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d07416d94d0>]}
[0m09:55:44.624716 [debug] [MainThread]: Flushing usage events
[0m09:55:45.861745 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:56:48.039427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77467669dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774677ec9d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774675d756d0>]}


============================== 09:56:48.044684 | 00a46963-6797-4f1b-957a-f00585054d56 ==============================
[0m09:56:48.044684 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:56:48.045421 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/logs', 'profiles_dir': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:56:48.269631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00a46963-6797-4f1b-957a-f00585054d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774676370180>]}
[0m09:56:48.340442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00a46963-6797-4f1b-957a-f00585054d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77467594d480>]}
[0m09:56:48.341516 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:56:48.433139 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:56:48.589012 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:56:48.589715 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/stg_chicago_crimes.sql
[0m09:56:49.071613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00a46963-6797-4f1b-957a-f00585054d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77467430d050>]}
[0m09:56:49.168656 [debug] [MainThread]: Wrote artifact WritableManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/manifest.json
[0m09:56:49.171370 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/semantic_manifest.json
[0m09:56:49.196296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00a46963-6797-4f1b-957a-f00585054d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774674365220>]}
[0m09:56:49.196976 [info ] [MainThread]: Found 1 model, 3 data tests, 1 source, 433 macros
[0m09:56:49.197426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00a46963-6797-4f1b-957a-f00585054d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774673bcd550>]}
[0m09:56:49.201250 [info ] [MainThread]: 
[0m09:56:49.202219 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:56:49.202718 [info ] [MainThread]: 
[0m09:56:49.203650 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:56:49.205354 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m09:56:49.270470 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m09:56:49.271111 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m09:56:49.271573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:56:49.285863 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.014 seconds
[0m09:56:49.287552 [debug] [ThreadPool]: On list_analytics: Close
[0m09:56:49.289151 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_staging)
[0m09:56:49.296577 [debug] [ThreadPool]: Using postgres connection "list_analytics_staging"
[0m09:56:49.297089 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m09:56:49.297470 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:56:49.307351 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m09:56:49.308109 [debug] [ThreadPool]: Using postgres connection "list_analytics_staging"
[0m09:56:49.308879 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m09:56:49.312963 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m09:56:49.314453 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m09:56:49.315104 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m09:56:49.320678 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:49.321156 [debug] [MainThread]: On master: BEGIN
[0m09:56:49.321502 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:56:49.330985 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:56:49.331493 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:49.332305 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:56:49.342369 [debug] [MainThread]: SQL status: SELECT 29 in 0.009 seconds
[0m09:56:49.344317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00a46963-6797-4f1b-957a-f00585054d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774671a19570>]}
[0m09:56:49.344858 [debug] [MainThread]: On master: ROLLBACK
[0m09:56:49.345545 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:49.345942 [debug] [MainThread]: On master: BEGIN
[0m09:56:49.346666 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:56:49.347051 [debug] [MainThread]: On master: COMMIT
[0m09:56:49.347401 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:49.347786 [debug] [MainThread]: On master: COMMIT
[0m09:56:49.348490 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:56:49.348864 [debug] [MainThread]: On master: Close
[0m09:56:49.351616 [debug] [Thread-1 (]: Began running node model.analytics_dbt.stg_chicago_crimes
[0m09:56:49.352354 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_chicago_crimes ......................... [RUN]
[0m09:56:49.352936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.analytics_dbt.stg_chicago_crimes)
[0m09:56:49.353378 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.stg_chicago_crimes
[0m09:56:49.364438 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.stg_chicago_crimes"
[0m09:56:49.365726 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.stg_chicago_crimes
[0m09:56:49.422725 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.stg_chicago_crimes"
[0m09:56:49.423574 [debug] [Thread-1 (]: Using postgres connection "model.analytics_dbt.stg_chicago_crimes"
[0m09:56:49.424038 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: BEGIN
[0m09:56:49.424449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:56:49.434213 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m09:56:49.434708 [debug] [Thread-1 (]: Using postgres connection "model.analytics_dbt.stg_chicago_crimes"
[0m09:56:49.435163 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.stg_chicago_crimes"} */

  create view "analytics"."staging"."stg_chicago_crimes__dbt_tmp"
    
    
  as (
    -- models/staging/stg_chicago_crimes.sql


with raw as (
  select * from "analytics"."staging"."raw_chicago_crimes"
)

select
  raw.case_Number::varchar       as case_id,
  raw.event_datetime              as event_datetime,
  date(raw.event_datetime)        as crime_date,
  raw.primary_type                as crime_type,
  raw.description,
  raw.location_description        as location,
  (raw.arrest = 'true')           as is_arrest,
  (raw.domestic = 'true')         as is_domestic
from raw
  );
[0m09:56:49.436857 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column raw.case_number does not exist
LINE 15:   raw.case_Number::varchar       as case_id,
           ^
HINT:  Perhaps you meant to reference the column "raw.Case_Number".

[0m09:56:49.437318 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: ROLLBACK
[0m09:56:49.438091 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: Close
[0m09:56:49.448784 [debug] [Thread-1 (]: Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column raw.case_number does not exist
  LINE 15:   raw.case_Number::varchar       as case_id,
             ^
  HINT:  Perhaps you meant to reference the column "raw.Case_Number".
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql
[0m09:56:49.451102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00a46963-6797-4f1b-957a-f00585054d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774673bdea50>]}
[0m09:56:49.451966 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model staging.stg_chicago_crimes ................ [[31mERROR[0m in 0.10s]
[0m09:56:49.452675 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.stg_chicago_crimes
[0m09:56:49.453935 [debug] [Thread-4 (]: Marking all children of 'model.analytics_dbt.stg_chicago_crimes' to be skipped because of status 'error'.  Reason: Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column raw.case_number does not exist
  LINE 15:   raw.case_Number::varchar       as case_id,
             ^
  HINT:  Perhaps you meant to reference the column "raw.Case_Number".
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql.
[0m09:56:49.458195 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:49.458693 [debug] [MainThread]: On master: BEGIN
[0m09:56:49.459228 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:56:49.474175 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m09:56:49.474923 [debug] [MainThread]: On master: COMMIT
[0m09:56:49.475426 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:49.475892 [debug] [MainThread]: On master: COMMIT
[0m09:56:49.476970 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:56:49.477551 [debug] [MainThread]: On master: Close
[0m09:56:49.478200 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:56:49.478999 [debug] [MainThread]: Connection 'model.analytics_dbt.stg_chicago_crimes' was properly closed.
[0m09:56:49.480205 [info ] [MainThread]: 
[0m09:56:49.481625 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m09:56:49.484462 [debug] [MainThread]: Command end result
[0m09:56:49.613660 [debug] [MainThread]: Wrote artifact WritableManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/manifest.json
[0m09:56:49.615749 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/semantic_manifest.json
[0m09:56:49.624418 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/run_results.json
[0m09:56:49.624950 [info ] [MainThread]: 
[0m09:56:49.625510 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:56:49.626158 [info ] [MainThread]: 
[0m09:56:49.626887 [error] [MainThread]:   Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column raw.case_number does not exist
  LINE 15:   raw.case_Number::varchar       as case_id,
             ^
  HINT:  Perhaps you meant to reference the column "raw.Case_Number".
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql
[0m09:56:49.627461 [info ] [MainThread]: 
[0m09:56:49.628034 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:56:49.630419 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6510978, "process_in_blocks": "24712", "process_kernel_time": 0.274055, "process_mem_max_rss": "121572", "process_out_blocks": "2608", "process_user_time": 2.969767}
[0m09:56:49.631239 [debug] [MainThread]: Command `dbt run` failed at 09:56:49.631051 after 1.65 seconds
[0m09:56:49.631935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774671be4cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774673fa07d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774673fa0190>]}
[0m09:56:49.632591 [debug] [MainThread]: Flushing usage events
[0m09:56:50.152183 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:50:57.211583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8199891be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c819b0c1d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8198f616d0>]}


============================== 10:50:57.217998 | d6f23abe-80e1-4c40-a2f0-f2cbec73b456 ==============================
[0m10:50:57.217998 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:50:57.218606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_chicago_crimes', 'send_anonymous_usage_stats': 'True'}
[0m10:50:57.429140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6f23abe-80e1-4c40-a2f0-f2cbec73b456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8199564180>]}
[0m10:50:57.507457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6f23abe-80e1-4c40-a2f0-f2cbec73b456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8198b3d480>]}
[0m10:50:57.509034 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:50:57.607902 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:50:57.763634 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:50:57.764430 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/stg_chicago_crimes.sql
[0m10:50:58.257354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6f23abe-80e1-4c40-a2f0-f2cbec73b456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8197d5ce50>]}
[0m10:50:58.347111 [debug] [MainThread]: Wrote artifact WritableManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/manifest.json
[0m10:50:58.349621 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/semantic_manifest.json
[0m10:50:58.372857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6f23abe-80e1-4c40-a2f0-f2cbec73b456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8198144e60>]}
[0m10:50:58.373492 [info ] [MainThread]: Found 1 model, 3 data tests, 1 source, 433 macros
[0m10:50:58.373984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6f23abe-80e1-4c40-a2f0-f2cbec73b456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8196d1de10>]}
[0m10:50:58.378681 [info ] [MainThread]: 
[0m10:50:58.380345 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:50:58.381797 [info ] [MainThread]: 
[0m10:50:58.384065 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:50:58.389237 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m10:50:58.465749 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m10:50:58.466342 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m10:50:58.466892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:50:58.486260 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.019 seconds
[0m10:50:58.488188 [debug] [ThreadPool]: On list_analytics: Close
[0m10:50:58.490072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_staging)
[0m10:50:58.497962 [debug] [ThreadPool]: Using postgres connection "list_analytics_staging"
[0m10:50:58.498878 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m10:50:58.499601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:50:58.510922 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m10:50:58.511784 [debug] [ThreadPool]: Using postgres connection "list_analytics_staging"
[0m10:50:58.512604 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m10:50:58.518470 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m10:50:58.520462 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m10:50:58.521648 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m10:50:58.529551 [debug] [MainThread]: Using postgres connection "master"
[0m10:50:58.530144 [debug] [MainThread]: On master: BEGIN
[0m10:50:58.530583 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:50:58.546024 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m10:50:58.546490 [debug] [MainThread]: Using postgres connection "master"
[0m10:50:58.547063 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:50:58.557947 [debug] [MainThread]: SQL status: SELECT 29 in 0.010 seconds
[0m10:50:58.560279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6f23abe-80e1-4c40-a2f0-f2cbec73b456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8195c1d640>]}
[0m10:50:58.560933 [debug] [MainThread]: On master: ROLLBACK
[0m10:50:58.561794 [debug] [MainThread]: Using postgres connection "master"
[0m10:50:58.562259 [debug] [MainThread]: On master: BEGIN
[0m10:50:58.563070 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:50:58.563685 [debug] [MainThread]: On master: COMMIT
[0m10:50:58.564128 [debug] [MainThread]: Using postgres connection "master"
[0m10:50:58.564474 [debug] [MainThread]: On master: COMMIT
[0m10:50:58.565109 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:50:58.565494 [debug] [MainThread]: On master: Close
[0m10:50:58.569806 [debug] [Thread-1 (]: Began running node model.analytics_dbt.stg_chicago_crimes
[0m10:50:58.570523 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_chicago_crimes ......................... [RUN]
[0m10:50:58.571376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.analytics_dbt.stg_chicago_crimes)
[0m10:50:58.572024 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.stg_chicago_crimes
[0m10:50:58.590044 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.stg_chicago_crimes"
[0m10:50:58.591733 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.stg_chicago_crimes
[0m10:50:58.656718 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.stg_chicago_crimes"
[0m10:50:58.658095 [debug] [Thread-1 (]: Using postgres connection "model.analytics_dbt.stg_chicago_crimes"
[0m10:50:58.658746 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: BEGIN
[0m10:50:58.659395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:50:58.672136 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m10:50:58.672730 [debug] [Thread-1 (]: Using postgres connection "model.analytics_dbt.stg_chicago_crimes"
[0m10:50:58.673251 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.stg_chicago_crimes"} */

  create view "analytics"."staging"."stg_chicago_crimes__dbt_tmp"
    
    
  as (
    -- models/staging/stg_chicago_crimes.sql


with raw as (
  select * from "staging"."raw_chicago_crimes"
)

select
  raw.case_Number::varchar       as case_id,
  raw.event_datetime              as event_datetime,
  date(raw.event_datetime)        as crime_date,
  raw.primary_type                as crime_type,
  raw.description,
  raw.location_description        as location,
  (raw.arrest = 'true')           as is_arrest,
  (raw.domestic = 'true')         as is_domestic
from raw
  );
[0m10:50:58.675831 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column raw.case_number does not exist
LINE 15:   raw.case_Number::varchar       as case_id,
           ^
HINT:  Perhaps you meant to reference the column "raw.Case_Number".

[0m10:50:58.676441 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: ROLLBACK
[0m10:50:58.677588 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: Close
[0m10:50:58.694311 [debug] [Thread-1 (]: Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column raw.case_number does not exist
  LINE 15:   raw.case_Number::varchar       as case_id,
             ^
  HINT:  Perhaps you meant to reference the column "raw.Case_Number".
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql
[0m10:50:58.696588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6f23abe-80e1-4c40-a2f0-f2cbec73b456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8196dd6bd0>]}
[0m10:50:58.697442 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model staging.stg_chicago_crimes ................ [[31mERROR[0m in 0.12s]
[0m10:50:58.698238 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.stg_chicago_crimes
[0m10:50:58.699142 [debug] [Thread-4 (]: Marking all children of 'model.analytics_dbt.stg_chicago_crimes' to be skipped because of status 'error'.  Reason: Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column raw.case_number does not exist
  LINE 15:   raw.case_Number::varchar       as case_id,
             ^
  HINT:  Perhaps you meant to reference the column "raw.Case_Number".
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql.
[0m10:50:58.702292 [debug] [MainThread]: Using postgres connection "master"
[0m10:50:58.702805 [debug] [MainThread]: On master: BEGIN
[0m10:50:58.703272 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:50:58.721256 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m10:50:58.722120 [debug] [MainThread]: On master: COMMIT
[0m10:50:58.722825 [debug] [MainThread]: Using postgres connection "master"
[0m10:50:58.723417 [debug] [MainThread]: On master: COMMIT
[0m10:50:58.724558 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:50:58.725270 [debug] [MainThread]: On master: Close
[0m10:50:58.726377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:50:58.727321 [debug] [MainThread]: Connection 'model.analytics_dbt.stg_chicago_crimes' was properly closed.
[0m10:50:58.728294 [info ] [MainThread]: 
[0m10:50:58.729636 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m10:50:58.732381 [debug] [MainThread]: Command end result
[0m10:50:58.862736 [debug] [MainThread]: Wrote artifact WritableManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/manifest.json
[0m10:50:58.864846 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/semantic_manifest.json
[0m10:50:58.872619 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/run_results.json
[0m10:50:58.873141 [info ] [MainThread]: 
[0m10:50:58.873715 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:50:58.874306 [info ] [MainThread]: 
[0m10:50:58.874979 [error] [MainThread]:   Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column raw.case_number does not exist
  LINE 15:   raw.case_Number::varchar       as case_id,
             ^
  HINT:  Perhaps you meant to reference the column "raw.Case_Number".
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql
[0m10:50:58.875454 [info ] [MainThread]: 
[0m10:50:58.875976 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:50:58.877964 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7288897, "process_in_blocks": "50112", "process_kernel_time": 0.268586, "process_mem_max_rss": "120496", "process_out_blocks": "2608", "process_user_time": 3.075162}
[0m10:50:58.878747 [debug] [MainThread]: Command `dbt run` failed at 10:50:58.878569 after 1.73 seconds
[0m10:50:58.879422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8195de92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8195c9f570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8195c9e8f0>]}
[0m10:50:58.880064 [debug] [MainThread]: Flushing usage events
[0m10:51:00.375350 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:51:29.632005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7704e4271be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7704e5ac9d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7704e39616d0>]}


============================== 10:51:29.635629 | a233f736-7d02-4a04-a6c4-aed192174b1a ==============================
[0m10:51:29.635629 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:51:29.636268 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_chicago_crimes', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:51:29.838498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a233f736-7d02-4a04-a6c4-aed192174b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7704e3f64180>]}
[0m10:51:29.923423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a233f736-7d02-4a04-a6c4-aed192174b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7704e353d480>]}
[0m10:51:29.924563 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:51:30.015151 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:51:30.144607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:51:30.145384 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/stg_chicago_crimes.sql
[0m10:51:30.638759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a233f736-7d02-4a04-a6c4-aed192174b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7704e275ce50>]}
[0m10:51:30.726843 [debug] [MainThread]: Wrote artifact WritableManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/manifest.json
[0m10:51:30.729657 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/semantic_manifest.json
[0m10:51:30.742258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a233f736-7d02-4a04-a6c4-aed192174b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7704e2b44e60>]}
[0m10:51:30.742855 [info ] [MainThread]: Found 1 model, 3 data tests, 1 source, 433 macros
[0m10:51:30.743243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a233f736-7d02-4a04-a6c4-aed192174b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7704e171de10>]}
[0m10:51:30.745137 [info ] [MainThread]: 
[0m10:51:30.745690 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:51:30.746236 [info ] [MainThread]: 
[0m10:51:30.747146 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:51:30.748596 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m10:51:30.829571 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m10:51:30.830347 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m10:51:30.831150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:30.844880 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.014 seconds
[0m10:51:30.846977 [debug] [ThreadPool]: On list_analytics: Close
[0m10:51:30.848576 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_staging)
[0m10:51:30.856207 [debug] [ThreadPool]: Using postgres connection "list_analytics_staging"
[0m10:51:30.857021 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m10:51:30.857691 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:51:30.868060 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m10:51:30.868764 [debug] [ThreadPool]: Using postgres connection "list_analytics_staging"
[0m10:51:30.869424 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m10:51:30.874460 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m10:51:30.877078 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m10:51:30.878176 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m10:51:30.884547 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:30.885058 [debug] [MainThread]: On master: BEGIN
[0m10:51:30.885456 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:51:30.895979 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m10:51:30.896728 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:30.897815 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:51:30.906947 [debug] [MainThread]: SQL status: SELECT 29 in 0.009 seconds
[0m10:51:30.909091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a233f736-7d02-4a04-a6c4-aed192174b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7704e061d640>]}
[0m10:51:30.909653 [debug] [MainThread]: On master: ROLLBACK
[0m10:51:30.910451 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:30.910898 [debug] [MainThread]: On master: BEGIN
[0m10:51:30.911906 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:51:30.912330 [debug] [MainThread]: On master: COMMIT
[0m10:51:30.912730 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:30.913120 [debug] [MainThread]: On master: COMMIT
[0m10:51:30.913732 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:51:30.914247 [debug] [MainThread]: On master: Close
[0m10:51:30.916799 [debug] [Thread-1 (]: Began running node model.analytics_dbt.stg_chicago_crimes
[0m10:51:30.917570 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_chicago_crimes ......................... [RUN]
[0m10:51:30.918191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.analytics_dbt.stg_chicago_crimes)
[0m10:51:30.918657 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.stg_chicago_crimes
[0m10:51:30.930194 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.stg_chicago_crimes"
[0m10:51:30.931431 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.stg_chicago_crimes
[0m10:51:30.994464 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.stg_chicago_crimes"
[0m10:51:30.995361 [debug] [Thread-1 (]: Using postgres connection "model.analytics_dbt.stg_chicago_crimes"
[0m10:51:30.995980 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: BEGIN
[0m10:51:30.996424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:51:31.006369 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m10:51:31.006957 [debug] [Thread-1 (]: Using postgres connection "model.analytics_dbt.stg_chicago_crimes"
[0m10:51:31.007429 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.stg_chicago_crimes"} */

  create view "analytics"."staging"."stg_chicago_crimes__dbt_tmp"
    
    
  as (
    -- models/staging/stg_chicago_crimes.sql


with raw as (
  select
    "Case_Number"   as case_number,    -- lower-case alias
    event_datetime,
    primary_type,
    description,
    location_description,
    arrest,
    domestic
  from "staging"."raw_chicago_crimes"
)

select
  case_number    ::varchar   as case_id,
  event_datetime              as event_datetime,
  date(event_datetime)        as crime_date,
  primary_type                as crime_type,
  description,
  location_description        as location,
  (arrest = 'true')           as is_arrest,
  (domestic = 'true')         as is_domestic
from raw
  );
[0m10:51:31.008620 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "event_datetime" does not exist
LINE 13:     event_datetime,
             ^

[0m10:51:31.009109 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: ROLLBACK
[0m10:51:31.009964 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: Close
[0m10:51:31.017848 [debug] [Thread-1 (]: Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column "event_datetime" does not exist
  LINE 13:     event_datetime,
               ^
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql
[0m10:51:31.019644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a233f736-7d02-4a04-a6c4-aed192174b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7704e17d2bd0>]}
[0m10:51:31.020374 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model staging.stg_chicago_crimes ................ [[31mERROR[0m in 0.10s]
[0m10:51:31.021060 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.stg_chicago_crimes
[0m10:51:31.021749 [debug] [Thread-4 (]: Marking all children of 'model.analytics_dbt.stg_chicago_crimes' to be skipped because of status 'error'.  Reason: Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column "event_datetime" does not exist
  LINE 13:     event_datetime,
               ^
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql.
[0m10:51:31.025050 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:31.025673 [debug] [MainThread]: On master: BEGIN
[0m10:51:31.026182 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:51:31.038207 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:51:31.038813 [debug] [MainThread]: On master: COMMIT
[0m10:51:31.039228 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:31.039637 [debug] [MainThread]: On master: COMMIT
[0m10:51:31.040557 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:51:31.041281 [debug] [MainThread]: On master: Close
[0m10:51:31.042297 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:51:31.043240 [debug] [MainThread]: Connection 'model.analytics_dbt.stg_chicago_crimes' was properly closed.
[0m10:51:31.044375 [info ] [MainThread]: 
[0m10:51:31.045900 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m10:51:31.047917 [debug] [MainThread]: Command end result
[0m10:51:31.176270 [debug] [MainThread]: Wrote artifact WritableManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/manifest.json
[0m10:51:31.178413 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/semantic_manifest.json
[0m10:51:31.187430 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/run_results.json
[0m10:51:31.188162 [info ] [MainThread]: 
[0m10:51:31.188730 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:51:31.189239 [info ] [MainThread]: 
[0m10:51:31.189873 [error] [MainThread]:   Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column "event_datetime" does not exist
  LINE 13:     event_datetime,
               ^
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql
[0m10:51:31.190368 [info ] [MainThread]: 
[0m10:51:31.191013 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:51:31.192872 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6237328, "process_in_blocks": "0", "process_kernel_time": 0.223906, "process_mem_max_rss": "121012", "process_out_blocks": "2600", "process_user_time": 2.947766}
[0m10:51:31.193885 [debug] [MainThread]: Command `dbt run` failed at 10:51:31.193627 after 1.63 seconds
[0m10:51:31.194582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7704e07e52e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7704e069f570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7704e069e8f0>]}
[0m10:51:31.195236 [debug] [MainThread]: Flushing usage events
[0m10:51:31.724389 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:55:17.691332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b2ce59dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b2cfdddd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b2cdc916d0>]}


============================== 10:55:17.695026 | 485e0707-86da-4493-b280-b3eefd534775 ==============================
[0m10:55:17.695026 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:55:17.695640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_chicago_crimes', 'send_anonymous_usage_stats': 'True'}
[0m10:55:17.893569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '485e0707-86da-4493-b280-b3eefd534775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b2ce290180>]}
[0m10:55:17.964441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '485e0707-86da-4493-b280-b3eefd534775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b2cd869480>]}
[0m10:55:17.965252 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:55:18.056607 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:55:18.159339 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:55:18.159863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '485e0707-86da-4493-b280-b3eefd534775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b2cd107c50>]}
[0m10:55:19.580536 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.analytics_dbt.staging
[0m10:55:19.595619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '485e0707-86da-4493-b280-b3eefd534775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b2cc50aa80>]}
[0m10:55:19.699147 [debug] [MainThread]: Wrote artifact WritableManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/manifest.json
[0m10:55:19.701357 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/semantic_manifest.json
[0m10:55:19.714130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '485e0707-86da-4493-b280-b3eefd534775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b2cd1c4210>]}
[0m10:55:19.714666 [info ] [MainThread]: Found 1 model, 3 data tests, 1 source, 433 macros
[0m10:55:19.715064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '485e0707-86da-4493-b280-b3eefd534775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b2cc9db930>]}
[0m10:55:19.716904 [info ] [MainThread]: 
[0m10:55:19.717444 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:55:19.717824 [info ] [MainThread]: 
[0m10:55:19.718526 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:55:19.719857 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m10:55:19.783908 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m10:55:19.784519 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m10:55:19.785358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:55:19.799801 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.014 seconds
[0m10:55:19.801915 [debug] [ThreadPool]: On list_analytics: Close
[0m10:55:19.803814 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_staging)
[0m10:55:19.813379 [debug] [ThreadPool]: Using postgres connection "list_analytics_staging"
[0m10:55:19.814199 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m10:55:19.814878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:55:19.826093 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m10:55:19.826619 [debug] [ThreadPool]: Using postgres connection "list_analytics_staging"
[0m10:55:19.827160 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m10:55:19.831666 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m10:55:19.833529 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m10:55:19.834447 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m10:55:19.840148 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:19.840716 [debug] [MainThread]: On master: BEGIN
[0m10:55:19.841169 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:55:19.852912 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:55:19.853387 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:19.853887 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:55:19.863620 [debug] [MainThread]: SQL status: SELECT 29 in 0.009 seconds
[0m10:55:19.866436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '485e0707-86da-4493-b280-b3eefd534775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b2cbdfdcd0>]}
[0m10:55:19.867348 [debug] [MainThread]: On master: ROLLBACK
[0m10:55:19.868447 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:19.868969 [debug] [MainThread]: On master: BEGIN
[0m10:55:19.869981 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:55:19.870408 [debug] [MainThread]: On master: COMMIT
[0m10:55:19.870832 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:19.871251 [debug] [MainThread]: On master: COMMIT
[0m10:55:19.871976 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:55:19.872763 [debug] [MainThread]: On master: Close
[0m10:55:19.875749 [debug] [Thread-1 (]: Began running node model.analytics_dbt.stg_chicago_crimes
[0m10:55:19.876553 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_chicago_crimes ......................... [RUN]
[0m10:55:19.877312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.analytics_dbt.stg_chicago_crimes)
[0m10:55:19.877962 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.stg_chicago_crimes
[0m10:55:19.890065 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.stg_chicago_crimes"
[0m10:55:19.891395 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.stg_chicago_crimes
[0m10:55:19.949315 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.stg_chicago_crimes"
[0m10:55:19.950123 [debug] [Thread-1 (]: Using postgres connection "model.analytics_dbt.stg_chicago_crimes"
[0m10:55:19.950573 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: BEGIN
[0m10:55:19.950993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:55:19.960513 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m10:55:19.961078 [debug] [Thread-1 (]: Using postgres connection "model.analytics_dbt.stg_chicago_crimes"
[0m10:55:19.961914 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.stg_chicago_crimes"} */

  create view "analytics"."staging"."stg_chicago_crimes__dbt_tmp"
    
    
  as (
    -- models/staging/stg_chicago_crimes.sql


with raw as (
  select
    "Case_Number"   as case_number,    -- lower-case alias
    event_datetime,
    primary_type,
    description,
    location_description,
    arrest,
    domestic
  from "staging"."raw_chicago_crimes"
)

select
  case_number    ::varchar   as case_id,
  event_datetime              as event_datetime,
  date(event_datetime)        as crime_date,
  primary_type                as crime_type,
  description,
  location_description        as location,
  (arrest = 'true')           as is_arrest,
  (domestic = 'true')         as is_domestic
from raw
  );
[0m10:55:19.962966 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "event_datetime" does not exist
LINE 13:     event_datetime,
             ^

[0m10:55:19.963414 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: ROLLBACK
[0m10:55:19.964168 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: Close
[0m10:55:19.971390 [debug] [Thread-1 (]: Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column "event_datetime" does not exist
  LINE 13:     event_datetime,
               ^
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql
[0m10:55:19.974207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '485e0707-86da-4493-b280-b3eefd534775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b2ca9795a0>]}
[0m10:55:19.975485 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model staging.stg_chicago_crimes ................ [[31mERROR[0m in 0.10s]
[0m10:55:19.976510 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.stg_chicago_crimes
[0m10:55:19.977738 [debug] [Thread-4 (]: Marking all children of 'model.analytics_dbt.stg_chicago_crimes' to be skipped because of status 'error'.  Reason: Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column "event_datetime" does not exist
  LINE 13:     event_datetime,
               ^
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql.
[0m10:55:19.981114 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:19.981614 [debug] [MainThread]: On master: BEGIN
[0m10:55:19.982019 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:55:19.994835 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m10:55:19.995666 [debug] [MainThread]: On master: COMMIT
[0m10:55:19.996474 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:19.997016 [debug] [MainThread]: On master: COMMIT
[0m10:55:19.998207 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:55:19.998823 [debug] [MainThread]: On master: Close
[0m10:55:19.999681 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:55:20.000359 [debug] [MainThread]: Connection 'model.analytics_dbt.stg_chicago_crimes' was properly closed.
[0m10:55:20.000903 [info ] [MainThread]: 
[0m10:55:20.001416 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m10:55:20.002590 [debug] [MainThread]: Command end result
[0m10:55:20.046070 [debug] [MainThread]: Wrote artifact WritableManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/manifest.json
[0m10:55:20.048297 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/semantic_manifest.json
[0m10:55:20.057006 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/run_results.json
[0m10:55:20.057557 [info ] [MainThread]: 
[0m10:55:20.058306 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:55:20.058928 [info ] [MainThread]: 
[0m10:55:20.059667 [error] [MainThread]:   Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column "event_datetime" does not exist
  LINE 13:     event_datetime,
               ^
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql
[0m10:55:20.060192 [info ] [MainThread]: 
[0m10:55:20.060726 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:55:20.063064 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.436275, "process_in_blocks": "32", "process_kernel_time": 0.217576, "process_mem_max_rss": "120936", "process_out_blocks": "2608", "process_user_time": 3.777655}
[0m10:55:20.064441 [debug] [MainThread]: Command `dbt run` failed at 10:55:20.064144 after 2.44 seconds
[0m10:55:20.065511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b2ca827570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b2cb9afe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b2ce8bd4d0>]}
[0m10:55:20.066622 [debug] [MainThread]: Flushing usage events
[0m10:55:21.295201 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:57:54.221661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734b20785be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734b21d99d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734b1fc9d6d0>]}


============================== 10:57:54.225054 | 0d3b0e0c-90bb-400a-ba09-02796479ba99 ==============================
[0m10:57:54.225054 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:57:54.225610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_chicago_crimes', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:57:54.438406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d3b0e0c-90bb-400a-ba09-02796479ba99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734b202a0180>]}
[0m10:57:54.510411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d3b0e0c-90bb-400a-ba09-02796479ba99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734b1f879480>]}
[0m10:57:54.511249 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:57:54.604917 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:57:54.734026 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:57:54.734715 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/stg_chicago_crimes.sql
[0m10:57:55.219115 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.analytics_dbt.staging
[0m10:57:55.240707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d3b0e0c-90bb-400a-ba09-02796479ba99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734b1e118e50>]}
[0m10:57:55.349764 [debug] [MainThread]: Wrote artifact WritableManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/manifest.json
[0m10:57:55.352224 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/semantic_manifest.json
[0m10:57:55.364920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d3b0e0c-90bb-400a-ba09-02796479ba99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734b1ed7ce60>]}
[0m10:57:55.365650 [info ] [MainThread]: Found 1 model, 3 data tests, 1 source, 433 macros
[0m10:57:55.366157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d3b0e0c-90bb-400a-ba09-02796479ba99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734b1d959e10>]}
[0m10:57:55.368417 [info ] [MainThread]: 
[0m10:57:55.369148 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:57:55.369611 [info ] [MainThread]: 
[0m10:57:55.370404 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:57:55.371885 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m10:57:55.433900 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m10:57:55.434522 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m10:57:55.435162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:55.449234 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.014 seconds
[0m10:57:55.451222 [debug] [ThreadPool]: On list_analytics: Close
[0m10:57:55.452958 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_staging)
[0m10:57:55.460586 [debug] [ThreadPool]: Using postgres connection "list_analytics_staging"
[0m10:57:55.461227 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m10:57:55.461715 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:55.473161 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m10:57:55.473695 [debug] [ThreadPool]: Using postgres connection "list_analytics_staging"
[0m10:57:55.474217 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m10:57:55.478665 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m10:57:55.480231 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m10:57:55.480911 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m10:57:55.486264 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:55.486792 [debug] [MainThread]: On master: BEGIN
[0m10:57:55.487207 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:57:55.497634 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m10:57:55.498409 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:55.499347 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:57:55.511300 [debug] [MainThread]: SQL status: SELECT 29 in 0.011 seconds
[0m10:57:55.513996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d3b0e0c-90bb-400a-ba09-02796479ba99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734b1c859640>]}
[0m10:57:55.514660 [debug] [MainThread]: On master: ROLLBACK
[0m10:57:55.515619 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:55.516285 [debug] [MainThread]: On master: BEGIN
[0m10:57:55.517222 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:57:55.517657 [debug] [MainThread]: On master: COMMIT
[0m10:57:55.518203 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:55.518904 [debug] [MainThread]: On master: COMMIT
[0m10:57:55.519619 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:57:55.520090 [debug] [MainThread]: On master: Close
[0m10:57:55.522825 [debug] [Thread-1 (]: Began running node model.analytics_dbt.stg_chicago_crimes
[0m10:57:55.523529 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_chicago_crimes ......................... [RUN]
[0m10:57:55.524156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.analytics_dbt.stg_chicago_crimes)
[0m10:57:55.524648 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.stg_chicago_crimes
[0m10:57:55.539316 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.stg_chicago_crimes"
[0m10:57:55.540625 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.stg_chicago_crimes
[0m10:57:55.606334 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.stg_chicago_crimes"
[0m10:57:55.607433 [debug] [Thread-1 (]: Using postgres connection "model.analytics_dbt.stg_chicago_crimes"
[0m10:57:55.607983 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: BEGIN
[0m10:57:55.608467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:55.619816 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m10:57:55.620413 [debug] [Thread-1 (]: Using postgres connection "model.analytics_dbt.stg_chicago_crimes"
[0m10:57:55.621267 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.stg_chicago_crimes"} */

  create view "analytics"."staging"."stg_chicago_crimes__dbt_tmp"
    
    
  as (
    -- models/staging/stg_chicago_crimes.sql


with raw as (
  select
    "Case_Number"   as case_number,    -- lower-case alias
    event_datetime,
    primary_type,
    description,
    location_description,
    arrest,
    domestic
  from "staging"."raw_chicago_crimes"
)

select
  id::varchar   as case_id,
  Date              as event_datetime,
  date(Date)        as crime_date,
  primary_type                as crime_type,
  description,
  location_description        as location,
  (arrest = 'true')           as is_arrest,
  (domestic = 'true')         as is_domestic
from raw
  );
[0m10:57:55.622886 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "event_datetime" does not exist
LINE 13:     event_datetime,
             ^

[0m10:57:55.623383 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: ROLLBACK
[0m10:57:55.624247 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: Close
[0m10:57:55.631449 [debug] [Thread-1 (]: Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column "event_datetime" does not exist
  LINE 13:     event_datetime,
               ^
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql
[0m10:57:55.634137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d3b0e0c-90bb-400a-ba09-02796479ba99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734b1d532bd0>]}
[0m10:57:55.634988 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model staging.stg_chicago_crimes ................ [[31mERROR[0m in 0.11s]
[0m10:57:55.635744 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.stg_chicago_crimes
[0m10:57:55.636959 [debug] [Thread-4 (]: Marking all children of 'model.analytics_dbt.stg_chicago_crimes' to be skipped because of status 'error'.  Reason: Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column "event_datetime" does not exist
  LINE 13:     event_datetime,
               ^
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql.
[0m10:57:55.640449 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:55.641059 [debug] [MainThread]: On master: BEGIN
[0m10:57:55.641570 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:57:55.654756 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m10:57:55.655368 [debug] [MainThread]: On master: COMMIT
[0m10:57:55.655815 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:55.656365 [debug] [MainThread]: On master: COMMIT
[0m10:57:55.657625 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:57:55.658270 [debug] [MainThread]: On master: Close
[0m10:57:55.659197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:55.659760 [debug] [MainThread]: Connection 'model.analytics_dbt.stg_chicago_crimes' was properly closed.
[0m10:57:55.660334 [info ] [MainThread]: 
[0m10:57:55.660871 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m10:57:55.662217 [debug] [MainThread]: Command end result
[0m10:57:55.802076 [debug] [MainThread]: Wrote artifact WritableManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/manifest.json
[0m10:57:55.804451 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/semantic_manifest.json
[0m10:57:55.812986 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/run_results.json
[0m10:57:55.813534 [info ] [MainThread]: 
[0m10:57:55.814213 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:57:55.814927 [info ] [MainThread]: 
[0m10:57:55.816465 [error] [MainThread]:   Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column "event_datetime" does not exist
  LINE 13:     event_datetime,
               ^
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql
[0m10:57:55.817686 [info ] [MainThread]: 
[0m10:57:55.819021 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:57:55.822010 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6597462, "process_in_blocks": "0", "process_kernel_time": 0.207647, "process_mem_max_rss": "121076", "process_out_blocks": "2608", "process_user_time": 2.979934}
[0m10:57:55.823554 [debug] [MainThread]: Command `dbt run` failed at 10:57:55.823238 after 1.66 seconds
[0m10:57:55.824832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734b1c8252e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734b1c8db570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734b1c8da8f0>]}
[0m10:57:55.826277 [debug] [MainThread]: Flushing usage events
[0m10:57:56.407727 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:58:09.281354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae51909dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae51a8c1d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae5187756d0>]}


============================== 10:58:09.292914 | 6cb2c1bc-8ba7-4bd1-b5e1-c347dfc9879d ==============================
[0m10:58:09.292914 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:58:09.294724 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_chicago_crimes', 'send_anonymous_usage_stats': 'True'}
[0m10:58:09.655555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6cb2c1bc-8ba7-4bd1-b5e1-c347dfc9879d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae518d70180>]}
[0m10:58:09.735091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6cb2c1bc-8ba7-4bd1-b5e1-c347dfc9879d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae518349480>]}
[0m10:58:09.736052 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:58:09.876881 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:58:10.098526 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:58:10.099060 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:58:10.105884 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.analytics_dbt.staging
[0m10:58:10.192259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cb2c1bc-8ba7-4bd1-b5e1-c347dfc9879d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae51830f750>]}
[0m10:58:10.354271 [debug] [MainThread]: Wrote artifact WritableManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/manifest.json
[0m10:58:10.359076 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/semantic_manifest.json
[0m10:58:10.380580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cb2c1bc-8ba7-4bd1-b5e1-c347dfc9879d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae517952300>]}
[0m10:58:10.381669 [info ] [MainThread]: Found 1 model, 3 data tests, 1 source, 433 macros
[0m10:58:10.382450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cb2c1bc-8ba7-4bd1-b5e1-c347dfc9879d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae516d651d0>]}
[0m10:58:10.387891 [info ] [MainThread]: 
[0m10:58:10.389945 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:58:10.391479 [info ] [MainThread]: 
[0m10:58:10.394237 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:58:10.399270 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m10:58:10.505750 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m10:58:10.506645 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m10:58:10.507352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:10.522889 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.015 seconds
[0m10:58:10.526915 [debug] [ThreadPool]: On list_analytics: Close
[0m10:58:10.530890 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_staging)
[0m10:58:10.554186 [debug] [ThreadPool]: Using postgres connection "list_analytics_staging"
[0m10:58:10.556038 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m10:58:10.556855 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:58:10.579474 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m10:58:10.581294 [debug] [ThreadPool]: Using postgres connection "list_analytics_staging"
[0m10:58:10.582501 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m10:58:10.589307 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m10:58:10.591559 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m10:58:10.592853 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m10:58:10.603766 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:10.604443 [debug] [MainThread]: On master: BEGIN
[0m10:58:10.605101 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:58:10.621750 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m10:58:10.622498 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:10.623343 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:58:10.648185 [debug] [MainThread]: SQL status: SELECT 29 in 0.024 seconds
[0m10:58:10.650577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cb2c1bc-8ba7-4bd1-b5e1-c347dfc9879d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae5165c1160>]}
[0m10:58:10.651200 [debug] [MainThread]: On master: ROLLBACK
[0m10:58:10.652003 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:10.652449 [debug] [MainThread]: On master: BEGIN
[0m10:58:10.653499 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:58:10.654025 [debug] [MainThread]: On master: COMMIT
[0m10:58:10.654483 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:10.654943 [debug] [MainThread]: On master: COMMIT
[0m10:58:10.655811 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:58:10.656331 [debug] [MainThread]: On master: Close
[0m10:58:10.659762 [debug] [Thread-1 (]: Began running node model.analytics_dbt.stg_chicago_crimes
[0m10:58:10.661413 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_chicago_crimes ......................... [RUN]
[0m10:58:10.662629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.analytics_dbt.stg_chicago_crimes)
[0m10:58:10.663770 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.stg_chicago_crimes
[0m10:58:10.680950 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.stg_chicago_crimes"
[0m10:58:10.681921 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.stg_chicago_crimes
[0m10:58:10.771780 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.stg_chicago_crimes"
[0m10:58:10.773388 [debug] [Thread-1 (]: Using postgres connection "model.analytics_dbt.stg_chicago_crimes"
[0m10:58:10.773993 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: BEGIN
[0m10:58:10.774489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:10.788325 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m10:58:10.789384 [debug] [Thread-1 (]: Using postgres connection "model.analytics_dbt.stg_chicago_crimes"
[0m10:58:10.790171 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.stg_chicago_crimes"} */

  create view "analytics"."staging"."stg_chicago_crimes__dbt_tmp"
    
    
  as (
    -- models/staging/stg_chicago_crimes.sql


with raw as (
  select
    "Case_Number"   as case_number,    -- lower-case alias
    event_datetime,
    primary_type,
    description,
    location_description,
    arrest,
    domestic
  from "staging"."raw_chicago_crimes"
)

select
  id::varchar   as case_id,
  Date              as event_datetime,
  date(Date)        as crime_date,
  primary_type                as crime_type,
  description,
  location_description        as location,
  (arrest = 'true')           as is_arrest,
  (domestic = 'true')         as is_domestic
from raw
  );
[0m10:58:10.791950 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "event_datetime" does not exist
LINE 13:     event_datetime,
             ^

[0m10:58:10.793159 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: ROLLBACK
[0m10:58:10.795005 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: Close
[0m10:58:10.805822 [debug] [Thread-1 (]: Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column "event_datetime" does not exist
  LINE 13:     event_datetime,
               ^
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql
[0m10:58:10.809796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cb2c1bc-8ba7-4bd1-b5e1-c347dfc9879d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae516589a90>]}
[0m10:58:10.811655 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model staging.stg_chicago_crimes ................ [[31mERROR[0m in 0.14s]
[0m10:58:10.813082 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.stg_chicago_crimes
[0m10:58:10.814764 [debug] [Thread-4 (]: Marking all children of 'model.analytics_dbt.stg_chicago_crimes' to be skipped because of status 'error'.  Reason: Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column "event_datetime" does not exist
  LINE 13:     event_datetime,
               ^
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql.
[0m10:58:10.820689 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:10.822006 [debug] [MainThread]: On master: BEGIN
[0m10:58:10.822771 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:58:10.843783 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m10:58:10.844493 [debug] [MainThread]: On master: COMMIT
[0m10:58:10.845059 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:10.846245 [debug] [MainThread]: On master: COMMIT
[0m10:58:10.848242 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:58:10.849779 [debug] [MainThread]: On master: Close
[0m10:58:10.851827 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:58:10.852790 [debug] [MainThread]: Connection 'model.analytics_dbt.stg_chicago_crimes' was properly closed.
[0m10:58:10.853803 [info ] [MainThread]: 
[0m10:58:10.855036 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m10:58:10.860736 [debug] [MainThread]: Command end result
[0m10:58:10.918348 [debug] [MainThread]: Wrote artifact WritableManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/manifest.json
[0m10:58:10.928279 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/semantic_manifest.json
[0m10:58:10.946168 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/run_results.json
[0m10:58:10.947317 [info ] [MainThread]: 
[0m10:58:10.948251 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:58:10.948983 [info ] [MainThread]: 
[0m10:58:10.949992 [error] [MainThread]:   Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column "event_datetime" does not exist
  LINE 13:     event_datetime,
               ^
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql
[0m10:58:10.950925 [info ] [MainThread]: 
[0m10:58:10.953013 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:58:10.958255 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8482454, "process_in_blocks": "0", "process_kernel_time": 0.278595, "process_mem_max_rss": "116552", "process_out_blocks": "1752", "process_user_time": 3.405059}
[0m10:58:10.961454 [debug] [MainThread]: Command `dbt run` failed at 10:58:10.960540 after 1.85 seconds
[0m10:58:10.964266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae516d2fac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae5161c2c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae5161c20d0>]}
[0m10:58:10.967173 [debug] [MainThread]: Flushing usage events
[0m10:58:11.486076 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:58:44.071330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7613e2c9dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7613e44c9d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7613e236d6d0>]}


============================== 10:58:44.074680 | b8a6fa9f-e287-4d66-8bdb-54726a139aba ==============================
[0m10:58:44.074680 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:58:44.075312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/logs', 'profiles_dir': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_chicago_crimes', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:58:44.259723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8a6fa9f-e287-4d66-8bdb-54726a139aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7613e2970180>]}
[0m10:58:44.350345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8a6fa9f-e287-4d66-8bdb-54726a139aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7613e1f49480>]}
[0m10:58:44.351390 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:58:44.481690 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:58:44.645549 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:58:44.646887 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/stg_chicago_crimes.sql
[0m10:58:45.217694 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.analytics_dbt.staging
[0m10:58:45.231834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8a6fa9f-e287-4d66-8bdb-54726a139aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7613e0900e50>]}
[0m10:58:45.330560 [debug] [MainThread]: Wrote artifact WritableManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/manifest.json
[0m10:58:45.333095 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/semantic_manifest.json
[0m10:58:45.345656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8a6fa9f-e287-4d66-8bdb-54726a139aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7613e1554e60>]}
[0m10:58:45.346199 [info ] [MainThread]: Found 1 model, 3 data tests, 1 source, 433 macros
[0m10:58:45.346617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8a6fa9f-e287-4d66-8bdb-54726a139aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7613e012de10>]}
[0m10:58:45.348331 [info ] [MainThread]: 
[0m10:58:45.348674 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:58:45.349035 [info ] [MainThread]: 
[0m10:58:45.349625 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:58:45.350776 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m10:58:45.396258 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m10:58:45.396969 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m10:58:45.397674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:45.417612 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.020 seconds
[0m10:58:45.422451 [debug] [ThreadPool]: On list_analytics: Close
[0m10:58:45.425921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_staging)
[0m10:58:45.440950 [debug] [ThreadPool]: Using postgres connection "list_analytics_staging"
[0m10:58:45.442259 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m10:58:45.443366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:58:45.457246 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m10:58:45.458059 [debug] [ThreadPool]: Using postgres connection "list_analytics_staging"
[0m10:58:45.458869 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m10:58:45.464817 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m10:58:45.468855 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m10:58:45.470062 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m10:58:45.476899 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:45.477519 [debug] [MainThread]: On master: BEGIN
[0m10:58:45.478017 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:58:45.490985 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m10:58:45.491453 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:45.491893 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:58:45.501575 [debug] [MainThread]: SQL status: SELECT 29 in 0.009 seconds
[0m10:58:45.503645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8a6fa9f-e287-4d66-8bdb-54726a139aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7613df02d640>]}
[0m10:58:45.504185 [debug] [MainThread]: On master: ROLLBACK
[0m10:58:45.504789 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:45.505144 [debug] [MainThread]: On master: BEGIN
[0m10:58:45.505882 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:58:45.506222 [debug] [MainThread]: On master: COMMIT
[0m10:58:45.506555 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:45.506913 [debug] [MainThread]: On master: COMMIT
[0m10:58:45.507431 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:58:45.507772 [debug] [MainThread]: On master: Close
[0m10:58:45.510092 [debug] [Thread-1 (]: Began running node model.analytics_dbt.stg_chicago_crimes
[0m10:58:45.511052 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_chicago_crimes ......................... [RUN]
[0m10:58:45.511875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.analytics_dbt.stg_chicago_crimes)
[0m10:58:45.512482 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.stg_chicago_crimes
[0m10:58:45.531302 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.stg_chicago_crimes"
[0m10:58:45.532423 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.stg_chicago_crimes
[0m10:58:45.583090 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.stg_chicago_crimes"
[0m10:58:45.584142 [debug] [Thread-1 (]: Using postgres connection "model.analytics_dbt.stg_chicago_crimes"
[0m10:58:45.584647 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: BEGIN
[0m10:58:45.585296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:45.594406 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m10:58:45.595022 [debug] [Thread-1 (]: Using postgres connection "model.analytics_dbt.stg_chicago_crimes"
[0m10:58:45.595642 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.stg_chicago_crimes"} */

  create view "analytics"."staging"."stg_chicago_crimes__dbt_tmp"
    
    
  as (
    -- models/staging/stg_chicago_crimes.sql


with raw as (
  select
    "Case_Number"   as case_number,    -- lower-case alias
    Date,
    primary_type,
    description,
    location_description,
    arrest,
    domestic
  from "staging"."raw_chicago_crimes"
)

select
  Case_Number::varchar   as case_id,
  Date              as event_datetime,
  date(Date)        as crime_date,
  primary_type                as crime_type,
  description,
  location_description        as location,
  (arrest = 'true')           as is_arrest,
  (domestic = 'true')         as is_domestic
from raw
  );
[0m10:58:45.596685 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "date" does not exist
LINE 13:     Date,
             ^
HINT:  Perhaps you meant to reference the column "raw_chicago_crimes.Date".

[0m10:58:45.597123 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: ROLLBACK
[0m10:58:45.597766 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: Close
[0m10:58:45.604293 [debug] [Thread-1 (]: Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column "date" does not exist
  LINE 13:     Date,
               ^
  HINT:  Perhaps you meant to reference the column "raw_chicago_crimes.Date".
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql
[0m10:58:45.606032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a6fa9f-e287-4d66-8bdb-54726a139aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7613e01da2d0>]}
[0m10:58:45.606795 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model staging.stg_chicago_crimes ................ [[31mERROR[0m in 0.09s]
[0m10:58:45.607691 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.stg_chicago_crimes
[0m10:58:45.608550 [debug] [Thread-4 (]: Marking all children of 'model.analytics_dbt.stg_chicago_crimes' to be skipped because of status 'error'.  Reason: Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column "date" does not exist
  LINE 13:     Date,
               ^
  HINT:  Perhaps you meant to reference the column "raw_chicago_crimes.Date".
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql.
[0m10:58:45.611361 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:45.611915 [debug] [MainThread]: On master: BEGIN
[0m10:58:45.612320 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:58:45.625234 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m10:58:45.625739 [debug] [MainThread]: On master: COMMIT
[0m10:58:45.626208 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:45.626632 [debug] [MainThread]: On master: COMMIT
[0m10:58:45.627627 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:58:45.628151 [debug] [MainThread]: On master: Close
[0m10:58:45.628907 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:58:45.629619 [debug] [MainThread]: Connection 'model.analytics_dbt.stg_chicago_crimes' was properly closed.
[0m10:58:45.630401 [info ] [MainThread]: 
[0m10:58:45.631293 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m10:58:45.632725 [debug] [MainThread]: Command end result
[0m10:58:45.759276 [debug] [MainThread]: Wrote artifact WritableManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/manifest.json
[0m10:58:45.762057 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/semantic_manifest.json
[0m10:58:45.770242 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/run_results.json
[0m10:58:45.770688 [info ] [MainThread]: 
[0m10:58:45.771252 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:58:45.771870 [info ] [MainThread]: 
[0m10:58:45.773018 [error] [MainThread]:   Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column "date" does not exist
  LINE 13:     Date,
               ^
  HINT:  Perhaps you meant to reference the column "raw_chicago_crimes.Date".
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql
[0m10:58:45.774026 [info ] [MainThread]: 
[0m10:58:45.775077 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:58:45.777629 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7622074, "process_in_blocks": "0", "process_kernel_time": 0.189675, "process_mem_max_rss": "121232", "process_out_blocks": "2608", "process_user_time": 3.042797}
[0m10:58:45.779064 [debug] [MainThread]: Command `dbt run` failed at 10:58:45.778747 after 1.76 seconds
[0m10:58:45.780164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7613df1f92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7613df0af570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7613df0ae8f0>]}
[0m10:58:45.781215 [debug] [MainThread]: Flushing usage events
[0m10:58:46.308158 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:59:05.864006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d01cb1b9be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d01cc999d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d01ca88d6d0>]}


============================== 10:59:05.867421 | c3f646d3-1fc5-4d50-984c-f1d0324389ad ==============================
[0m10:59:05.867421 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:59:05.868025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_chicago_crimes', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:59:06.066233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3f646d3-1fc5-4d50-984c-f1d0324389ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d01cae8c180>]}
[0m10:59:06.136162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3f646d3-1fc5-4d50-984c-f1d0324389ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d01ca465480>]}
[0m10:59:06.137048 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:59:06.231712 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:59:06.354464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:59:06.355272 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/stg_chicago_crimes.sql
[0m10:59:06.841564 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.analytics_dbt.staging
[0m10:59:06.859876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3f646d3-1fc5-4d50-984c-f1d0324389ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d01c8d08e50>]}
[0m10:59:06.979715 [debug] [MainThread]: Wrote artifact WritableManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/manifest.json
[0m10:59:06.982123 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/semantic_manifest.json
[0m10:59:06.995467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3f646d3-1fc5-4d50-984c-f1d0324389ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d01c996ce60>]}
[0m10:59:06.996070 [info ] [MainThread]: Found 1 model, 3 data tests, 1 source, 433 macros
[0m10:59:06.996520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3f646d3-1fc5-4d50-984c-f1d0324389ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d01c8545e10>]}
[0m10:59:06.998647 [info ] [MainThread]: 
[0m10:59:06.999263 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:59:06.999656 [info ] [MainThread]: 
[0m10:59:07.000443 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:59:07.001788 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m10:59:07.072587 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m10:59:07.073359 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m10:59:07.073873 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:07.088723 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.015 seconds
[0m10:59:07.091074 [debug] [ThreadPool]: On list_analytics: Close
[0m10:59:07.093217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_staging)
[0m10:59:07.102083 [debug] [ThreadPool]: Using postgres connection "list_analytics_staging"
[0m10:59:07.102629 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m10:59:07.103142 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:59:07.114922 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m10:59:07.115496 [debug] [ThreadPool]: Using postgres connection "list_analytics_staging"
[0m10:59:07.115986 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m10:59:07.121072 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m10:59:07.122819 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m10:59:07.123702 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m10:59:07.131483 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:07.132372 [debug] [MainThread]: On master: BEGIN
[0m10:59:07.133098 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:59:07.146635 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m10:59:07.147553 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:07.148824 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:59:07.160298 [debug] [MainThread]: SQL status: SELECT 29 in 0.011 seconds
[0m10:59:07.162666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3f646d3-1fc5-4d50-984c-f1d0324389ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d01c7445640>]}
[0m10:59:07.163424 [debug] [MainThread]: On master: ROLLBACK
[0m10:59:07.164171 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:07.164607 [debug] [MainThread]: On master: BEGIN
[0m10:59:07.165575 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:59:07.166246 [debug] [MainThread]: On master: COMMIT
[0m10:59:07.166730 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:07.167162 [debug] [MainThread]: On master: COMMIT
[0m10:59:07.167819 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:59:07.168268 [debug] [MainThread]: On master: Close
[0m10:59:07.171085 [debug] [Thread-1 (]: Began running node model.analytics_dbt.stg_chicago_crimes
[0m10:59:07.171931 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_chicago_crimes ......................... [RUN]
[0m10:59:07.172571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.analytics_dbt.stg_chicago_crimes)
[0m10:59:07.173069 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.stg_chicago_crimes
[0m10:59:07.184494 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.stg_chicago_crimes"
[0m10:59:07.185754 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.stg_chicago_crimes
[0m10:59:07.251368 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.stg_chicago_crimes"
[0m10:59:07.252256 [debug] [Thread-1 (]: Using postgres connection "model.analytics_dbt.stg_chicago_crimes"
[0m10:59:07.252773 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: BEGIN
[0m10:59:07.253268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:59:07.264366 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m10:59:07.265083 [debug] [Thread-1 (]: Using postgres connection "model.analytics_dbt.stg_chicago_crimes"
[0m10:59:07.265535 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.stg_chicago_crimes"} */

  create view "analytics"."staging"."stg_chicago_crimes__dbt_tmp"
    
    
  as (
    -- models/staging/stg_chicago_crimes.sql


with raw as (
  select
    "Case_Number"   as case_number,    -- lower-case alias
    "Date",
    primary_type,
    description,
    location_description,
    arrest,
    domestic
  from "staging"."raw_chicago_crimes"
)

select
  Case_Number::varchar   as case_id,
  "Date"              as event_datetime,
  date("Date")        as crime_date,
  primary_type                as crime_type,
  description,
  location_description        as location,
  (arrest = 'true')           as is_arrest,
  (domestic = 'true')         as is_domestic
from raw
  );
[0m10:59:07.266599 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "primary_type" does not exist
LINE 14:     primary_type,
             ^
HINT:  Perhaps you meant to reference the column "raw_chicago_crimes.Primary_Type".

[0m10:59:07.267076 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: ROLLBACK
[0m10:59:07.267905 [debug] [Thread-1 (]: On model.analytics_dbt.stg_chicago_crimes: Close
[0m10:59:07.274041 [debug] [Thread-1 (]: Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column "primary_type" does not exist
  LINE 14:     primary_type,
               ^
  HINT:  Perhaps you meant to reference the column "raw_chicago_crimes.Primary_Type".
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql
[0m10:59:07.275922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f646d3-1fc5-4d50-984c-f1d0324389ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d01c8566bd0>]}
[0m10:59:07.276682 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model staging.stg_chicago_crimes ................ [[31mERROR[0m in 0.10s]
[0m10:59:07.277409 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.stg_chicago_crimes
[0m10:59:07.278274 [debug] [Thread-4 (]: Marking all children of 'model.analytics_dbt.stg_chicago_crimes' to be skipped because of status 'error'.  Reason: Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column "primary_type" does not exist
  LINE 14:     primary_type,
               ^
  HINT:  Perhaps you meant to reference the column "raw_chicago_crimes.Primary_Type".
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql.
[0m10:59:07.281421 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:07.282050 [debug] [MainThread]: On master: BEGIN
[0m10:59:07.282455 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:59:07.294679 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:59:07.295241 [debug] [MainThread]: On master: COMMIT
[0m10:59:07.295667 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:07.296059 [debug] [MainThread]: On master: COMMIT
[0m10:59:07.296805 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:59:07.297413 [debug] [MainThread]: On master: Close
[0m10:59:07.298219 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:59:07.298741 [debug] [MainThread]: Connection 'model.analytics_dbt.stg_chicago_crimes' was properly closed.
[0m10:59:07.299426 [info ] [MainThread]: 
[0m10:59:07.300171 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m10:59:07.301588 [debug] [MainThread]: Command end result
[0m10:59:07.433748 [debug] [MainThread]: Wrote artifact WritableManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/manifest.json
[0m10:59:07.435888 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/semantic_manifest.json
[0m10:59:07.444363 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/run_results.json
[0m10:59:07.444993 [info ] [MainThread]: 
[0m10:59:07.445535 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:59:07.446035 [info ] [MainThread]: 
[0m10:59:07.446884 [error] [MainThread]:   Database Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  column "primary_type" does not exist
  LINE 14:     primary_type,
               ^
  HINT:  Perhaps you meant to reference the column "raw_chicago_crimes.Primary_Type".
  compiled code at target/run/analytics_dbt/models/stg_chicago_crimes.sql
[0m10:59:07.447439 [info ] [MainThread]: 
[0m10:59:07.448059 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:59:07.449852 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6439142, "process_in_blocks": "0", "process_kernel_time": 0.227571, "process_mem_max_rss": "120836", "process_out_blocks": "2600", "process_user_time": 2.966408}
[0m10:59:07.450661 [debug] [MainThread]: Command `dbt run` failed at 10:59:07.450485 after 1.65 seconds
[0m10:59:07.451370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d01c74112e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d01c74c7570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d01c74c68f0>]}
[0m10:59:07.451987 [debug] [MainThread]: Flushing usage events
[0m10:59:08.046877 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:54:37.295324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718720ab5be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7187222b5d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7187201896d0>]}


============================== 11:54:37.303298 | b296d63e-0740-4ece-a670-733f22afb4bb ==============================
[0m11:54:37.303298 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:54:37.305600 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_chicago_crimes', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:54:37.528676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b296d63e-0740-4ece-a670-733f22afb4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718720788180>]}
[0m11:54:37.601543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b296d63e-0740-4ece-a670-733f22afb4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71871fd61480>]}
[0m11:54:37.602455 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:54:37.690359 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:54:37.846552 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:54:37.847715 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/schema.yml
[0m11:54:37.848305 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/stg_chicago_crimes.sql
[0m11:54:38.464416 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.analytics_dbt.staging
[0m11:54:38.479456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b296d63e-0740-4ece-a670-733f22afb4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71871fd27b50>]}
[0m11:54:38.616725 [debug] [MainThread]: Wrote artifact WritableManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/manifest.json
[0m11:54:38.619566 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/semantic_manifest.json
[0m11:54:38.633795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b296d63e-0740-4ece-a670-733f22afb4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71871f56a3f0>]}
[0m11:54:38.634419 [info ] [MainThread]: Found 1 model, 2 data tests, 2 sources, 433 macros
[0m11:54:38.634884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b296d63e-0740-4ece-a670-733f22afb4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71871ed46eb0>]}
[0m11:54:38.636925 [info ] [MainThread]: 
[0m11:54:38.637491 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:54:38.637903 [info ] [MainThread]: 
[0m11:54:38.638701 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:54:38.640128 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m11:54:38.703343 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m11:54:38.704430 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m11:54:38.705165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:54:38.719853 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.015 seconds
[0m11:54:38.721928 [debug] [ThreadPool]: On list_analytics: Close
[0m11:54:38.723526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_staging)
[0m11:54:38.733619 [debug] [ThreadPool]: Using postgres connection "list_analytics_staging"
[0m11:54:38.734234 [debug] [ThreadPool]: On list_analytics_staging: BEGIN
[0m11:54:38.734639 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:54:38.745049 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m11:54:38.745541 [debug] [ThreadPool]: Using postgres connection "list_analytics_staging"
[0m11:54:38.746024 [debug] [ThreadPool]: On list_analytics_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_analytics_staging"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m11:54:38.750939 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m11:54:38.752577 [debug] [ThreadPool]: On list_analytics_staging: ROLLBACK
[0m11:54:38.753289 [debug] [ThreadPool]: On list_analytics_staging: Close
[0m11:54:38.759185 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:38.759658 [debug] [MainThread]: On master: BEGIN
[0m11:54:38.760074 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:54:38.770523 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m11:54:38.771088 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:38.771539 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:54:38.780324 [debug] [MainThread]: SQL status: SELECT 29 in 0.008 seconds
[0m11:54:38.782313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b296d63e-0740-4ece-a670-733f22afb4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71871e5686d0>]}
[0m11:54:38.782915 [debug] [MainThread]: On master: ROLLBACK
[0m11:54:38.783596 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:38.783959 [debug] [MainThread]: On master: BEGIN
[0m11:54:38.784707 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:54:38.785154 [debug] [MainThread]: On master: COMMIT
[0m11:54:38.785499 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:38.785834 [debug] [MainThread]: On master: COMMIT
[0m11:54:38.786490 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:54:38.786875 [debug] [MainThread]: On master: Close
[0m11:54:38.789286 [debug] [Thread-1 (]: Began running node model.analytics_dbt.stg_chicago_crimes
[0m11:54:38.790083 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_chicago_crimes ......................... [RUN]
[0m11:54:38.790887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_staging, now model.analytics_dbt.stg_chicago_crimes)
[0m11:54:38.791656 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.stg_chicago_crimes
[0m11:54:38.826069 [debug] [Thread-1 (]: Compilation Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  'analytics' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:54:38.828379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b296d63e-0740-4ece-a670-733f22afb4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71871dd9a690>]}
[0m11:54:38.829341 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model staging.stg_chicago_crimes ................ [[31mERROR[0m in 0.04s]
[0m11:54:38.830136 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.stg_chicago_crimes
[0m11:54:38.830899 [debug] [Thread-4 (]: Marking all children of 'model.analytics_dbt.stg_chicago_crimes' to be skipped because of status 'error'.  Reason: Compilation Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  'analytics' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m11:54:38.833477 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:38.834072 [debug] [MainThread]: On master: BEGIN
[0m11:54:38.834515 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:54:38.847503 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m11:54:38.849421 [debug] [MainThread]: On master: COMMIT
[0m11:54:38.850715 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:38.852095 [debug] [MainThread]: On master: COMMIT
[0m11:54:38.853889 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:54:38.854557 [debug] [MainThread]: On master: Close
[0m11:54:38.855485 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:54:38.856111 [debug] [MainThread]: Connection 'model.analytics_dbt.stg_chicago_crimes' was properly closed.
[0m11:54:38.856752 [info ] [MainThread]: 
[0m11:54:38.857417 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m11:54:38.858777 [debug] [MainThread]: Command end result
[0m11:54:39.000555 [debug] [MainThread]: Wrote artifact WritableManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/manifest.json
[0m11:54:39.002641 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/semantic_manifest.json
[0m11:54:39.010111 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/yovcho-ivanov/data-pipeline/dbt_project/analytics_dbt/target/run_results.json
[0m11:54:39.010619 [info ] [MainThread]: 
[0m11:54:39.011342 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:54:39.012036 [info ] [MainThread]: 
[0m11:54:39.013223 [error] [MainThread]:   Compilation Error in model stg_chicago_crimes (models/stg_chicago_crimes.sql)
  'analytics' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:54:39.014347 [info ] [MainThread]: 
[0m11:54:39.015585 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:54:39.018749 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8391774, "process_in_blocks": "224", "process_kernel_time": 0.228365, "process_mem_max_rss": "121240", "process_out_blocks": "2576", "process_user_time": 3.150241}
[0m11:54:39.020641 [debug] [MainThread]: Command `dbt run` failed at 11:54:39.020225 after 1.84 seconds
[0m11:54:39.021944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71871dd71860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71871cc43ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71871cc43f70>]}
[0m11:54:39.023220 [debug] [MainThread]: Flushing usage events
[0m11:54:40.489213 [debug] [MainThread]: An error was encountered while trying to flush usage events
